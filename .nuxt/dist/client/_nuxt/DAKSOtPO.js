import{f as c,s as v,q as x,x as y,c as m,a as e,z as o,A as a,k as n,K as w,n as V,t as k,b as A,w as C,y as S,j as U,e as B,o as p,d as N,_ as T}from"./Bes98wj2.js";const q={class:"main-content max-w-3xl"},$={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},D={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},E={class:"grid grid-cols-1 md:grid-cols-2 gap-4 items-end"},F={key:0,class:"text-xs text-gray-500 mt-1"},M={class:"flex gap-3"},j=c({__name:"create",setup(H){const u=U(),b=v(),d=x(),s=y({titre:"",statut:0}),f=async i=>{const t=i.target.files;if(!t||!t[0])return;const r=new FormData;r.append("file",t[0]),r.append("type","manga");try{const l=await $fetch(`${u.public.apiBase}/api/media/upload`,{method:"POST",body:r,headers:d.getAuthHeaders()});s.image=l.filename}catch(l){console.error("Upload error",l),alert("Échec de l'upload")}},g=async()=>{try{await $fetch(`${u.public.apiBase}/api/admin/mangas`,{method:"POST",headers:{"Content-Type":"application/json",...d.getAuthHeaders()},body:s}),b.push("/admin/mangas")}catch(i){console.error(i),alert(i?.data?.message||"Erreur lors de la création")}};return(i,t)=>{const r=B;return p(),m("div",q,[t[18]||(t[18]=e("h1",{class:"section-title mb-4"},"Créer un manga",-1)),e("form",{class:"card p-5 space-y-4",onSubmit:S(g,["prevent"])},[e("div",null,[t[7]||(t[7]=e("label",{class:"block text-sm mb-1"},"Titre *",-1)),o(e("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>n(s).titre=l),class:"form-input w-full",required:""},null,512),[[a,n(s).titre]])]),e("div",$,[e("div",null,[t[8]||(t[8]=e("label",{class:"block text-sm mb-1"},"Auteur",-1)),o(e("input",{"onUpdate:modelValue":t[1]||(t[1]=l=>n(s).auteur=l),class:"form-input w-full"},null,512),[[a,n(s).auteur]])]),e("div",null,[t[9]||(t[9]=e("label",{class:"block text-sm mb-1"},"Année (AAAA)",-1)),o(e("input",{"onUpdate:modelValue":t[2]||(t[2]=l=>n(s).annee=l),maxlength:"4",class:"form-input w-full"},null,512),[[a,n(s).annee]])])]),e("div",D,[e("div",null,[t[10]||(t[10]=e("label",{class:"block text-sm mb-1"},"Éditeur",-1)),o(e("input",{"onUpdate:modelValue":t[3]||(t[3]=l=>n(s).editeur=l),class:"form-input w-full"},null,512),[[a,n(s).editeur]])]),e("div",null,[t[11]||(t[11]=e("label",{class:"block text-sm mb-1"},"Nb Volumes (numérique)",-1)),o(e("input",{"onUpdate:modelValue":t[4]||(t[4]=l=>n(s).nbVol=l),type:"number",min:"0",class:"form-input w-full"},null,512),[[a,n(s).nbVol,void 0,{number:!0}]])])]),e("div",null,[t[12]||(t[12]=e("label",{class:"block text-sm mb-1"},"Synopsis",-1)),o(e("textarea",{"onUpdate:modelValue":t[5]||(t[5]=l=>n(s).synopsis=l),rows:"4",class:"form-input w-full"},null,512),[[a,n(s).synopsis]])]),e("div",E,[e("div",null,[t[14]||(t[14]=e("label",{class:"block text-sm mb-1"},"Statut",-1)),o(e("select",{"onUpdate:modelValue":t[6]||(t[6]=l=>n(s).statut=l),class:"form-input w-full"},t[13]||(t[13]=[e("option",{value:1},"Affichée",-1),e("option",{value:2},"En attente",-1),e("option",{value:0},"Bloquée",-1)]),512),[[w,n(s).statut,void 0,{number:!0}]])]),e("div",null,[t[15]||(t[15]=e("label",{class:"block text-sm mb-1"},"Image (upload)",-1)),e("input",{type:"file",accept:"image/*",onChange:f},null,32),n(s).image?(p(),m("div",F,"Fichier: "+k(n(s).image),1)):V("",!0)])]),e("div",M,[t[17]||(t[17]=e("button",{type:"submit",class:"btn-primary"},"Créer",-1)),A(r,{to:"/admin/mangas",class:"btn-secondary"},{default:C(()=>t[16]||(t[16]=[N("Annuler",-1)])),_:1,__:[16]})])],32)])}}}),O=T(j,[["__scopeId","data-v-9e3a898b"]]);export{O as default};
