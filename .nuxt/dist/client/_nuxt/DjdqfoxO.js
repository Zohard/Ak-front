import{f as P,q,g as E,H as c,h as Y,c as u,a as r,k as s,B as C,t as d,n as p,m as L,w as A,b as h,r as Q,d as y,e as W,p as D,v as R,o as l,_ as z}from"./CCeOfYC8.js";import{u as G}from"./B9jFdIe5.js";const H={class:"review-author flex items-start space-x-4"},J={class:"flex-shrink-0"},K=["src","alt"],O={class:"flex-1 min-w-0"},X={class:"flex items-start justify-between"},Z={class:"flex-1 min-w-0"},ee={class:"text-lg font-semibold text-gray-900 dark:text-white"},te={key:1},se={key:2,class:"ml-2 inline-flex"},oe={class:"mt-1 flex flex-wrap items-center gap-4 text-sm text-gray-600 dark:text-gray-400"},re={class:"flex items-center space-x-1"},ae={key:0,class:"flex items-center space-x-1"},ne={class:"flex items-center space-x-1"},ie={class:"mt-2 text-sm text-gray-500 dark:text-gray-400"},le={key:0,class:"flex-shrink-0 ml-4"},ce={key:0,class:"mt-3 text-sm text-gray-600 dark:text-gray-300"},ue={class:"line-clamp-2"},de={key:1,class:"mt-4 flex flex-wrap gap-2"},he=P({__name:"ReviewAuthor",props:{author:{},reviewDate:{},showFollowButton:{type:Boolean,default:!1},showQuickActions:{type:Boolean,default:!0}},emits:["follow","message"],setup(B,{emit:M}){const e=B,w=M,x=q(),{getAvatarUrl:S}=G(),m=E(!1),f=c(()=>e.author?.pseudo||"Utilisateur"),_=c(()=>e.author?.id?`/users/${e.author.id}`:null),b=c(()=>{if(!e.author)return null;if("avatar"in e.author&&e.author.avatar){let t=e.author.avatar;return t.startsWith("https://")&&(t.includes("casimages.com")||t.includes("imageshack")||t.includes("hostingpics.net"))&&(t=t.replace("https://","http://")),t}return null}),$=c(()=>f.value.charAt(0).toUpperCase()),U=c(()=>{if(!e.author?.pseudo)return"from-gray-500 to-gray-600";const t=["from-blue-500 to-blue-600","from-purple-500 to-purple-600","from-green-500 to-green-600","from-red-500 to-red-600","from-yellow-500 to-yellow-600","from-pink-500 to-pink-600","from-indigo-500 to-indigo-600","from-teal-500 to-teal-600"],o=e.author.pseudo.charCodeAt(0)%t.length;return t[o]}),F=c(()=>!e.author||!("isVerified"in e.author)?!1:e.author.isVerified||!1),k=c(()=>!e.author||!("bio"in e.author)?null:e.author.bio||null),v=c(()=>{const t={reviewsCount:0,averageRating:"0.0"};return!e.author||!("reviewsCount"in e.author)?t:{reviewsCount:e.author.reviewsCount||0,averageRating:(e.author.averageRating||0).toFixed(1)}}),I=c(()=>{if(!e.author||!("joinDate"in e.author)||!e.author.joinDate)return"longtemps";const t=new Date(e.author.joinDate),o=t.getFullYear(),n=new Date().getFullYear();return o===n?t.toLocaleDateString("fr-FR",{month:"long"}):o.toString()}),T=t=>{if(!t)return"";const o=new Date(t),a=Math.abs(new Date().getTime()-o.getTime()),i=Math.ceil(a/(1e3*60*60*24));if(i===1)return"hier";if(i<7)return`il y a ${i} jours`;if(i<30){const g=Math.floor(i/7);return`il y a ${g} semaine${g>1?"s":""}`}else{if(i<365)return`il y a ${Math.floor(i/30)} mois`;{const g=Math.floor(i/365);return`il y a ${g} an${g>1?"s":""}`}}},V=()=>{if(!x.isAuthenticated){D("/login?redirect="+encodeURIComponent(R().fullPath));return}e.author?.id&&(m.value=!m.value,w("follow",e.author.id,m.value))},j=()=>{if(!x.isAuthenticated){D("/login?redirect="+encodeURIComponent(R().fullPath));return}e.author?.id&&(w("message",e.author.id),alert("Système de messagerie à venir"))},N=t=>{const o=t.target,n=o.src;if(n.startsWith("https://")&&(n.includes("casimages.com")||n.includes("imageshack")||n.includes("hostingpics.net"))){const i=n.replace("https://","http://");if(!o.dataset.httpTried){o.dataset.httpTried="true",o.src=i;return}}const a=S(void 0,e.author?.id);o.src=a,o.style.opacity="0.8"};return Y(async()=>{x.isAuthenticated&&e.author?.id}),(t,o)=>{const n=W,a=Q("Icon");return l(),u("div",H,[r("div",J,[s(b)?(l(),u("img",{key:0,src:s(b),alt:`Avatar de ${s(f)}`,class:"w-16 h-16 rounded-full shadow-sm",onError:N},null,40,K)):(l(),u("div",{key:1,class:C(["w-16 h-16 rounded-full flex items-center justify-center text-white font-bold text-xl shadow-sm",`bg-gradient-to-br ${s(U)}`])},d(s($)),3))]),r("div",O,[r("div",X,[r("div",Z,[r("h4",ee,[s(_)?(l(),L(n,{key:0,to:s(_),class:"hover:text-blue-600 dark:hover:text-blue-400 transition-colors"},{default:A(()=>[y(d(s(f)),1)]),_:1},8,["to"])):(l(),u("span",te,d(s(f)),1)),s(F)?(l(),u("span",se,[h(a,{name:"heroicons:check-badge-solid",class:"w-5 h-5 text-blue-500",title:"Membre vérifié"})])):p("",!0)]),r("div",oe,[r("div",re,[h(a,{name:"heroicons:document-text",class:"w-4 h-4"}),r("span",null,d(s(v).reviewsCount)+" critiques",1)]),s(v).reviewsCount>0?(l(),u("div",ae,[h(a,{name:"heroicons:star",class:"w-4 h-4 text-yellow-400"}),r("span",null,d(s(v).averageRating)+"/10 moyenne",1)])):p("",!0),r("div",ne,[h(a,{name:"heroicons:calendar",class:"w-4 h-4"}),r("span",null,"Membre depuis "+d(s(I)),1)])]),r("div",ie,[h(a,{name:"heroicons:clock",class:"w-4 h-4 inline mr-1"}),y(" Publié "+d(T(t.reviewDate)),1)])]),t.showFollowButton?(l(),u("div",le,[r("button",{onClick:V,class:C(["px-4 py-2 rounded-lg text-sm font-medium transition-colors",s(m)?"bg-gray-100 text-gray-700 dark:bg-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600":"bg-blue-600 text-white hover:bg-blue-700"])},[h(a,{name:s(m)?"heroicons:user-minus":"heroicons:user-plus",class:"w-4 h-4 inline mr-1"},null,8,["name"]),y(" "+d(s(m)?"Ne plus suivre":"Suivre"),1)],2)])):p("",!0)]),s(k)?(l(),u("div",ce,[r("p",ue,d(s(k)),1)])):p("",!0),t.showQuickActions?(l(),u("div",de,[h(n,{to:`/reviews?author=${encodeURIComponent(s(f))}`,class:"inline-flex items-center space-x-1 px-3 py-1 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-md text-xs hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors"},{default:A(()=>[h(a,{name:"heroicons:document-text",class:"w-3 h-3"}),o[0]||(o[0]=r("span",null,"Toutes ses critiques",-1))]),_:1,__:[0]},8,["to"]),r("button",{onClick:j,class:"inline-flex items-center space-x-1 px-3 py-1 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-md text-xs hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors"},[h(a,{name:"heroicons:chat-bubble-left",class:"w-3 h-3"}),o[1]||(o[1]=r("span",null,"Message privé",-1))])])):p("",!0)])])}}}),fe=z(he,[["__scopeId","data-v-e8e9db12"]]);export{fe as default};
