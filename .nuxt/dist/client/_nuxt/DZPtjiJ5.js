import{f as Y,u as H,g as w,v as K,s as Q,G as V,H as A,I as X,c as a,a as r,n as u,b as m,d as x,z as q,A as W,k as s,J as R,K as D,E as Z,F as P,l as T,t as l,L as ee,j as te,r as re,o,B as se,p as ae,_ as oe}from"./CCeOfYC8.js";import{u as ne}from"./B9jFdIe5.js";import{u as le}from"./CC4fhe8Z.js";import{r as de}from"./BYwTe9_t.js";import"./BJ2ClxiI.js";const ie={class:"main-content"},ue={class:"page-header"},ge={class:"section-title flex items-center gap-3"},ce={class:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6 mb-8"},be={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},pe=["value"],me={key:0,class:"flex flex-wrap items-center gap-2 mt-4 pt-4 border-t border-gray-200 dark:border-gray-700"},ye={key:0,class:"inline-flex items-center gap-1 px-2 py-1 bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 text-xs rounded-full"},xe={key:1,class:"inline-flex items-center gap-1 px-2 py-1 bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200 text-xs rounded-full"},ve={key:2,class:"inline-flex items-center gap-1 px-2 py-1 bg-purple-100 dark:bg-purple-900 text-purple-800 dark:text-purple-200 text-xs rounded-full"},ke={key:0,class:"flex items-center justify-center py-12"},fe={key:1,class:"text-center py-12"},he={class:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-700 rounded-lg p-6 max-w-md mx-auto"},we={class:"text-red-600 dark:text-red-300 text-sm mb-4"},_e={key:2,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"},Ce=["onClick"],Ae={class:"relative"},qe={class:"aspect-[3/4] overflow-hidden"},Re=["src","alt"],Pe={key:1,class:"w-full h-full bg-gradient-to-br from-blue-100 to-blue-200 dark:from-blue-900 dark:to-blue-800 flex flex-col items-center justify-center p-4"},Te={class:"text-center"},Ne={class:"text-sm font-medium text-blue-700 dark:text-blue-300 mb-1"},Fe={key:0,class:"absolute top-3 right-3 bg-black/70 backdrop-blur-sm text-white px-2 py-1 rounded-full text-xs font-semibold flex items-center gap-1"},Se={key:1,class:"absolute top-3 left-3 bg-blue-600/90 backdrop-blur-sm text-white px-2 py-1 rounded-full text-xs font-semibold"},$e={class:"p-4 space-y-3"},Ie={class:"font-semibold text-lg text-gray-900 dark:text-white line-clamp-2 leading-tight"},Ue={class:"flex items-center gap-3 text-sm text-gray-600 dark:text-gray-400"},Ve={key:0,class:"flex items-center gap-1"},De={key:1,class:"flex items-center gap-1"},Me={key:0,class:"text-sm text-gray-600 dark:text-gray-400 line-clamp-3 leading-relaxed"},Ee={class:"flex items-center justify-between pt-2 border-t border-gray-200 dark:border-gray-700 text-xs text-gray-500 dark:text-gray-400"},je={key:0,class:"flex items-center gap-1"},ze={key:3,class:"text-center py-12"},Be={key:4,class:"flex justify-center mt-8"},Le={class:"flex items-center space-x-1"},Ge=["disabled"],Je={class:"flex items-center"},Oe={key:1,class:"px-2 py-2 text-sm bg-white dark:bg-gray-800 border-t border-b border-gray-300 dark:border-gray-600 text-gray-500"},Ye=["onClick"],He={key:2,class:"px-2 py-2 text-sm bg-white dark:bg-gray-800 border-t border-b border-gray-300 dark:border-gray-600 text-gray-500"},Ke=["disabled"],Qe={key:5,class:"text-center mt-4 text-sm text-gray-600 dark:text-gray-400"},Xe=Y({__name:"animes",async setup(We){let h,N;H({title:"Animes - Anime-Kun",meta:[{name:"description",content:"Découvrez notre collection d'animes avec critiques et notes de la communauté"}]});const g=w(1),b=w(""),c=w(""),i=w(""),y=K(),M=Q(),{getImageUrl:E,handleImageError:j}=ne();y.query.page&&(g.value=parseInt(y.query.page)||1),y.query.search&&(b.value=y.query.search),y.query.genre&&(c.value=y.query.genre),y.query.year&&(i.value=y.query.year);const z=new Date().getFullYear(),B=Array.from({length:30},(n,e)=>z-e),_=de(b,500);V([_,c,i],()=>{g.value=1});const L=A(()=>!!(b.value||c.value||i.value)),v=A(()=>{if(!p.value?.pagination?.totalPages)return[];const n=p.value.pagination.totalPages,e=g.value,d=2;let t=Math.max(1,e-d),k=Math.min(n,e+d);e-d<=1&&(k=Math.min(n,5)),e+d>=n&&(t=Math.max(1,n-4));const U=[];for(let C=t;C<=k;C++)U.push(C);return U}),{data:p,pending:G,error:F,refresh:S}=([h,N]=X(()=>le("/api/animes",{baseURL:te().public.apiBase,params:A(()=>({page:g.value,limit:12,search:_.value||void 0,genre:c.value||void 0,year:i.value?parseInt(i.value):void 0})),key:"animes-list",watch:[g,_,c,i]},"$fX9b-QMFtS")),h=await h,N(),h),J=n=>{const e=`/anime/${n.niceUrl||n.id}`;ae(e)},f=async n=>{g.value=n,await $()},$=async()=>{await ee();const n={};g.value>1&&(n.page=g.value.toString()),b.value&&(n.search=b.value),c.value&&(n.genre=c.value),i.value&&(n.year=i.value);const e=y.query;if(JSON.stringify(n)!==JSON.stringify(e))try{await M.push({query:n})}catch(t){console.debug("Navigation ignored:",t)}},O=()=>{b.value="",c.value="",i.value=""};V([b,c,i],()=>{clearTimeout(I),I=setTimeout($,300)});let I;return(n,e)=>{const d=re("Icon");return o(),a("div",ie,[r("div",ue,[r("h1",ge,[m(d,{name:"heroicons:film",class:"w-8 h-8 text-blue-600 dark:text-blue-400"}),e[12]||(e[12]=x(" Animes ",-1))]),e[13]||(e[13]=r("p",{class:"text-lg text-gray-600 dark:text-gray-300"}," Découvrez notre collection d'animes avec critiques et notes de la communauté ",-1))]),r("div",ce,[r("div",be,[r("div",null,[e[14]||(e[14]=r("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Recherche ",-1)),q(r("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>R(b)?b.value=t:null),type:"text",placeholder:"Nom de l'anime...",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"},null,512),[[W,s(b)]])]),r("div",null,[e[16]||(e[16]=r("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Genre ",-1)),q(r("select",{"onUpdate:modelValue":e[1]||(e[1]=t=>R(c)?c.value=t:null),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"},e[15]||(e[15]=[Z('<option value="" data-v-ed73782d>Tous les genres</option><option value="Action" data-v-ed73782d>Action</option><option value="Aventure" data-v-ed73782d>Aventure</option><option value="Comédie" data-v-ed73782d>Comédie</option><option value="Drame" data-v-ed73782d>Drame</option><option value="Fantastique" data-v-ed73782d>Fantastique</option><option value="Romance" data-v-ed73782d>Romance</option><option value="Science-fiction" data-v-ed73782d>Science-fiction</option>',8)]),512),[[D,s(c)]])]),r("div",null,[e[18]||(e[18]=r("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Année ",-1)),q(r("select",{"onUpdate:modelValue":e[2]||(e[2]=t=>R(i)?i.value=t:null),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white"},[e[17]||(e[17]=r("option",{value:""},"Toutes les années",-1)),(o(!0),a(P,null,T(s(B),t=>(o(),a("option",{key:t,value:t},l(t),9,pe))),128))],512),[[D,s(i)]])])]),s(L)?(o(),a("div",me,[e[19]||(e[19]=r("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"Filtres actifs:",-1)),s(b)?(o(),a("span",ye,[x(' Recherche: "'+l(s(b))+'" ',1),r("button",{onClick:e[3]||(e[3]=t=>b.value=""),class:"hover:bg-blue-200 dark:hover:bg-blue-800 rounded-full p-0.5"},[m(d,{name:"heroicons:x-mark",class:"w-3 h-3"})])])):u("",!0),s(c)?(o(),a("span",xe,[x(" Genre: "+l(s(c))+" ",1),r("button",{onClick:e[4]||(e[4]=t=>c.value=""),class:"hover:bg-green-200 dark:hover:bg-green-800 rounded-full p-0.5"},[m(d,{name:"heroicons:x-mark",class:"w-3 h-3"})])])):u("",!0),s(i)?(o(),a("span",ve,[x(" Année: "+l(s(i))+" ",1),r("button",{onClick:e[5]||(e[5]=t=>i.value=""),class:"hover:bg-purple-200 dark:hover:bg-purple-800 rounded-full p-0.5"},[m(d,{name:"heroicons:x-mark",class:"w-3 h-3"})])])):u("",!0),r("button",{onClick:O,class:"text-xs text-red-600 dark:text-red-400 hover:text-red-700 dark:hover:text-red-300 font-medium"}," Tout effacer ")])):u("",!0)]),s(G)?(o(),a("div",ke,e[20]||(e[20]=[r("div",{class:"animate-spin rounded-full h-8 w-8 border-2 border-blue-500 border-t-transparent"},null,-1),r("span",{class:"ml-3 text-gray-600 dark:text-gray-300"},"Chargement des animes...",-1)]))):s(F)?(o(),a("div",fe,[r("div",he,[e[21]||(e[21]=r("h3",{class:"text-lg font-medium text-red-800 dark:text-red-200 mb-2"},"Erreur de chargement",-1)),r("p",we,l(s(F)),1),r("button",{onClick:e[6]||(e[6]=(...t)=>s(S)&&s(S)(...t)),class:"btn-primary"},"Réessayer")])])):s(p)?.animes?.length?(o(),a("div",_e,[(o(!0),a(P,null,T(s(p).animes,t=>(o(),a("div",{key:t.id,class:"group relative bg-white dark:bg-gray-800 rounded-xl overflow-hidden shadow-lg hover:shadow-xl transition-all duration-300 hover:-translate-y-1 cursor-pointer",onClick:k=>J(t)},[r("div",Ae,[r("div",qe,[t.image?(o(),a("img",{key:0,src:s(E)(t.image,"anime"),alt:t.titre,class:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-105",loading:"lazy",onError:e[7]||(e[7]=k=>s(j)(k,void 0,"anime"))},null,40,Re)):(o(),a("div",Pe,[m(d,{name:"heroicons:film",class:"w-16 h-16 text-blue-500 dark:text-blue-400 mb-3"}),r("div",Te,[r("p",Ne,l(t.titre),1),e[22]||(e[22]=r("p",{class:"text-xs text-blue-600 dark:text-blue-400"},"Image bientôt disponible",-1))])]))]),t.moyenneNotes&&t.moyenneNotes>0?(o(),a("div",Fe,[m(d,{name:"heroicons:star",class:"w-3 h-3 text-yellow-400"}),r("span",null,l(t.moyenneNotes.toFixed(1)),1)])):u("",!0),t.nbEp?(o(),a("div",Se,l(t.nbEp)+" ép. ",1)):u("",!0)]),r("div",$e,[r("h3",Ie,l(t.titre),1),r("div",Ue,[t.annee?(o(),a("span",Ve,[m(d,{name:"heroicons:calendar",class:"w-3 h-3"}),x(" "+l(t.annee),1)])):u("",!0),t.realisateur?(o(),a("span",De,[m(d,{name:"heroicons:tv",class:"w-3 h-3"}),x(" "+l(t.realisateur),1)])):u("",!0)]),t.synopsis?(o(),a("p",Me,l(t.synopsis),1)):u("",!0),r("div",Ee,[t.nbReviews?(o(),a("span",je,[m(d,{name:"heroicons:chat-bubble-left",class:"w-3 h-3"}),x(" "+l(t.nbReviews)+" avis ",1)])):u("",!0),e[23]||(e[23]=r("span",{class:"text-blue-600 dark:text-blue-400 font-medium"},"Voir plus",-1))])])],8,Ce))),128))])):(o(),a("div",ze,e[24]||(e[24]=[r("h3",{class:"mt-2 text-sm font-medium text-gray-900 dark:text-white"},"Aucun anime trouvé",-1),r("p",{class:"mt-1 text-sm text-gray-500 dark:text-gray-400"},"Aucun anime disponible pour le moment.",-1)]))),s(p)?.pagination?.totalPages>1?(o(),a("div",Be,[r("div",Le,[r("button",{disabled:s(g)===1,onClick:e[8]||(e[8]=t=>f(s(g)-1)),class:"px-3 py-2 text-sm bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-l-md disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50 dark:hover:bg-gray-700 flex items-center gap-1"},[m(d,{name:"heroicons:chevron-left",class:"w-4 h-4"}),e[25]||(e[25]=x(" Précédent ",-1))],8,Ge),r("div",Je,[s(v)[0]>1?(o(),a("button",{key:0,onClick:e[9]||(e[9]=t=>f(1)),class:"px-3 py-2 text-sm bg-white dark:bg-gray-800 border-t border-b border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700"}," 1 ")):u("",!0),s(v)[0]>2?(o(),a("span",Oe," ... ")):u("",!0),(o(!0),a(P,null,T(s(v),t=>(o(),a("button",{key:t,class:se(["px-3 py-2 text-sm border-t border-b border-gray-300 dark:border-gray-600",t===s(g)?"bg-blue-600 text-white border-blue-600":"bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700 text-gray-900 dark:text-gray-100"]),onClick:k=>f(t)},l(t),11,Ye))),128)),s(v)[s(v).length-1]<s(p).pagination.totalPages-1?(o(),a("span",He," ... ")):u("",!0),s(v)[s(v).length-1]<s(p).pagination.totalPages?(o(),a("button",{key:3,onClick:e[10]||(e[10]=t=>f(s(p).pagination.totalPages)),class:"px-3 py-2 text-sm bg-white dark:bg-gray-800 border-t border-b border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700"},l(s(p).pagination.totalPages),1)):u("",!0)]),r("button",{disabled:s(g)===s(p).pagination.totalPages,onClick:e[11]||(e[11]=t=>f(s(g)+1)),class:"px-3 py-2 text-sm bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-r-md disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50 dark:hover:bg-gray-700 flex items-center gap-1"},[e[26]||(e[26]=x(" Suivant ",-1)),m(d,{name:"heroicons:chevron-right",class:"w-4 h-4"})],8,Ke)])])):u("",!0),s(p)?.pagination?(o(),a("div",Qe," Affichage de "+l((s(g)-1)*12+1)+" à "+l(Math.min(s(g)*12,s(p).pagination.total))+" sur "+l(s(p).pagination.total)+" animes ",1)):u("",!0)])}}}),at=oe(Xe,[["__scopeId","data-v-ed73782d"]]);export{at as default};
