import{f as Q,v as W,u as X,q as Y,g as x,H as Z,h as ee,G as te,c as i,k as a,a as e,b as l,t as c,w as f,n as C,d as m,F as _,l as w,z as $,M as A,j as se,e as re,r as ae,o,B as V,m as oe,N as ie,p as ne,_ as le}from"./CCeOfYC8.js";import de from"./CntGVgX6.js";import{u as ce}from"./B9jFdIe5.js";import"./B3ebZBhz.js";const ue={class:"min-h-screen bg-gray-50 dark:bg-gray-900"},ge={key:0,class:"flex items-center justify-center py-12"},xe={key:1,class:"container mx-auto px-4 py-8"},me={class:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-6 text-center"},be={class:"text-red-600 dark:text-red-300"},pe={key:2,class:"container mx-auto px-4 py-8"},he={class:"bg-white dark:bg-gray-800 rounded-lg shadow-lg overflow-hidden mb-8"},ye={class:"h-32 bg-gradient-to-r from-blue-500 to-purple-600 relative"},ve={key:0,class:"absolute top-4 right-4"},fe={class:"px-6 py-6 relative"},_e={class:"absolute -top-16 left-6"},we={class:"w-24 h-24 rounded-full border-4 border-white dark:border-gray-800 overflow-hidden bg-blue-500 flex items-center justify-center"},ke=["src","alt"],Ce={key:1,class:"text-white text-2xl font-bold"},$e={class:"ml-32"},Ae={class:"flex items-center justify-between"},qe={class:"text-2xl font-bold text-gray-900 dark:text-white mb-2"},Me={class:"flex flex-wrap gap-4 text-sm text-gray-600 dark:text-gray-400"},Re={class:"flex items-center"},De={key:0,class:"flex items-center"},Ie={key:0,class:"flex space-x-2"},Se={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},je={class:"bg-white dark:bg-gray-800 rounded-lg shadow p-6"},Ve={class:"flex items-center justify-between"},Be={class:"text-2xl font-bold text-gray-900 dark:text-white"},Le={class:"bg-white dark:bg-gray-800 rounded-lg shadow p-6"},ze={class:"flex items-center justify-between"},Fe={class:"text-2xl font-bold text-gray-900 dark:text-white"},Ne={class:"bg-white dark:bg-gray-800 rounded-lg shadow p-6"},Te={class:"flex items-center justify-between"},Ue={class:"text-2xl font-bold text-gray-900 dark:text-white"},Ee={class:"bg-white dark:bg-gray-800 rounded-lg shadow p-6"},Pe={class:"flex items-center justify-between"},Ge={class:"text-2xl font-bold text-gray-900 dark:text-white"},He={class:"bg-white dark:bg-gray-800 rounded-lg shadow-lg overflow-hidden"},Ke={class:"border-b border-gray-200 dark:border-gray-700"},Je={class:"flex space-x-8 px-6","aria-label":"Tabs"},Oe=["onClick"],Qe={class:"p-6"},We={class:"space-y-6"},Xe={class:"flex items-center justify-between"},Ye={key:0,class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Ze={key:1,class:"text-center py-8 text-gray-500 dark:text-gray-400"},et={class:"space-y-6"},tt={class:"flex items-center justify-between"},st={key:0,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},rt={class:"flex items-center justify-between mb-3"},at={class:"text-xs text-gray-500 dark:text-gray-400"},ot={class:"font-medium text-gray-900 dark:text-white mb-2"},it={class:"flex items-center gap-4 text-sm text-gray-600 dark:text-gray-400"},nt={class:"flex items-center gap-1"},lt={class:"flex items-center gap-1"},dt={key:1,class:"text-center py-8 text-gray-500 dark:text-gray-400"},ct={class:"space-y-6"},ut={key:0,class:"space-y-4"},gt={class:"flex-shrink-0"},xt={class:"flex-1"},mt={class:"text-sm text-gray-900 dark:text-white"},bt={class:"text-xs text-gray-500 dark:text-gray-400 mt-1"},pt={key:1,class:"text-center py-8 text-gray-500 dark:text-gray-400"},ht={class:"space-y-6"},yt={key:0,class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4"},vt={class:"space-y-2"},ft={class:"text-sm text-gray-600 dark:text-gray-400"},_t={class:"flex items-center space-x-2"},wt={class:"w-20 bg-gray-200 dark:bg-gray-600 rounded-full h-2"},kt={class:"text-sm text-gray-900 dark:text-white font-medium"},Ct=Q({__name:"[username]",setup($t){const I=W(),u=I.params.username;X({title:`Profil de ${u} - Anime-Kun V2`,meta:[{name:"description",content:`Consultez le profil public de ${u} sur Anime-Kun`}]});const q=Y(),h=se(),{getAvatarUrl:B}=ce(),M=x(!0),y=x(""),p=x("reviews"),n=x(null),v=x(null),R=x([]),D=x([]),k=x([]),S=x(!1),j=Z(()=>q.isAuthenticated&&q.user?.pseudo===u),L=[{id:"reviews",label:"Critiques"},{id:"collections",label:"Collections"},{id:"activity",label:"Activité"},{id:"stats",label:"Statistiques"}],z=t=>t?new Date(typeof t=="string"?parseInt(t)*1e3:t*1e3).toLocaleDateString("fr-FR",{year:"numeric",month:"long"}):"Inconnu",F=t=>{if(!t)return"Inconnue";const s=new Date(typeof t=="string"?parseInt(t)*1e3:t*1e3),g=Math.abs(new Date().getTime()-s.getTime()),r=Math.ceil(g/(1e3*60*60*24));if(r===1)return"hier";if(r<7)return`il y a ${r} jours`;if(r<30){const b=Math.floor(r/7);return`il y a ${b} semaine${b>1?"s":""}`}else return s.toLocaleDateString("fr-FR")},N=t=>({1:"bg-green-500",2:"bg-yellow-500",3:"bg-blue-500",4:"bg-red-500"})[t]||"bg-gray-500",T=t=>t?new Date(typeof t=="string"?parseInt(t)*1e3:t*1e3).toLocaleDateString("fr-FR",{year:"numeric",month:"short",day:"numeric"}):"",U=()=>(n.value?.pseudo||n.value?.username||u).charAt(0).toUpperCase(),E=()=>{const t=n.value?.nbPost||0;return t>=1e3?"Expert":t>=500?"Avancé":t>=100?"Actif":t>=10?"Membre":"Débutant"},P=t=>{switch(t){case"review":return"heroicons:star";case"forum_post":return"heroicons:chat-bubble-left";case"anime_rated":return"heroicons:film";case"manga_rated":return"heroicons:book-open";default:return"heroicons:clock"}},G=t=>{switch(t.type){case"review":return`A écrit une critique pour "${t.title}"`;case"forum_post":return`A posté un message dans "${t.title}"`;case"anime_rated":return`A noté l'anime "${t.title}"`;case"manga_rated":return`A noté le manga "${t.title}"`;default:return t.description||"Activité"}},H=t=>({id:t.id||t.idCritique,idCritique:t.idCritique||t.id,niceUrl:t.niceUrl,titre:t.titre,critique:t.critique||t.contenu,notation:t.notation||t.note,dateCritique:t.reviewDate||t.dateCritique||t.dateCreation,statut:typeof t.statut=="number"?t.statut:1,idMembre:t.idMembre||t.userId||0,idAnime:t.idAnime||t.animeId||0,idManga:t.idManga||t.mangaId||0,nbClics:t.nbClics||t.nbVues||0,anime:t.anime,manga:t.manga,membre:t.membre||{id:n.value?.id,pseudo:n.value?.pseudo,avatar:n.value?.avatar}}),K=t=>{ne(`/review/${t.id||t.idCritique}`)},J=()=>{console.log("Send message to",u)},O=async()=>{try{M.value=!0,y.value="";const t=await $fetch(`${h.public.apiBase}/api/users/public/${u}`);n.value=t.user;const s=await $fetch(`${h.public.apiBase}/api/users/public/${u}/stats`);v.value=s;const d=await $fetch(`${h.public.apiBase}/api/users/public/${u}/reviews?limit=4`);R.value=d.reviews||[];const g=await $fetch(`${h.public.apiBase}/api/users/public/${u}/activity?limit=5`);if(D.value=g.activities||[],n.value?.id)try{const r=await $fetch(`${h.public.apiBase}/api/collections?userId=${n.value.id}`);k.value=(r.data||[]).filter(b=>b.totalCount>0)}catch(r){console.warn("Failed to load user collections:",r),k.value=[]}}catch(t){t.status===404?y.value=`L'utilisateur "${u}" n'existe pas.`:y.value=t.message||"Erreur lors du chargement du profil",console.error("Error loading public profile:",t)}finally{M.value=!1}};return ee(()=>{O()}),te(()=>I.params.username,t=>{t!==u&&window.location.reload()}),(t,s)=>{const d=ae("Icon"),g=re;return o(),i("div",ue,[a(M)?(o(),i("div",ge,s[1]||(s[1]=[e("div",{class:"animate-spin rounded-full h-8 w-8 border-2 border-blue-500 border-t-transparent"},null,-1),e("span",{class:"ml-3 text-gray-600 dark:text-gray-300"},"Chargement du profil...",-1)]))):a(y)?(o(),i("div",xe,[e("div",me,[l(d,{name:"heroicons:exclamation-triangle",class:"w-12 h-12 text-red-500 mx-auto mb-4"}),s[3]||(s[3]=e("h2",{class:"text-xl font-semibold text-red-800 dark:text-red-200 mb-2"},"Utilisateur introuvable",-1)),e("p",be,c(a(y)),1),l(g,{to:"/",class:"mt-4 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700"},{default:f(()=>s[2]||(s[2]=[m(" Retour à l'accueil ",-1)])),_:1,__:[2]})])])):(o(),i("div",pe,[e("div",he,[e("div",ye,[a(j)?(o(),i("div",ve,[l(g,{to:"/profile",class:"inline-flex items-center px-3 py-1 border border-white/20 rounded-md text-sm font-medium text-white hover:bg-white/10 transition-colors"},{default:f(()=>[l(d,{name:"heroicons:pencil-square",class:"w-4 h-4 mr-1"}),s[4]||(s[4]=m(" Modifier ",-1))]),_:1,__:[4]})])):C("",!0)]),e("div",fe,[e("div",_e,[e("div",we,[a(n)?.avatar&&!a(S)?(o(),i("img",{key:0,src:a(B)(a(n).avatar),alt:a(n)?.pseudo||a(n)?.username,class:"w-full h-full object-cover",onError:s[0]||(s[0]=r=>S.value=!0)},null,40,ke)):(o(),i("span",Ce,c(U()),1))])]),e("div",$e,[e("div",Ae,[e("div",null,[e("h1",qe,c(a(n)?.pseudo||a(n)?.username),1),e("div",Me,[e("div",Re,[l(d,{name:"heroicons:calendar",class:"w-4 h-4 mr-1"}),m(" Membre depuis "+c(z(a(n)?.dateInscription)),1)]),a(n)?.lastLogin?(o(),i("div",De,[l(d,{name:"heroicons:clock",class:"w-4 h-4 mr-1"}),m(" Dernière connexion "+c(F(a(n).lastLogin)),1)])):C("",!0)])]),!a(j)&&a(q).isAuthenticated?(o(),i("div",Ie,[e("button",{onClick:J,class:"inline-flex items-center px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-sm font-medium text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors"},[l(d,{name:"heroicons:envelope",class:"w-4 h-4 mr-1"}),s[5]||(s[5]=m(" Message ",-1))])])):C("",!0)])])])]),e("div",Se,[e("div",je,[e("div",Ve,[e("div",null,[s[6]||(s[6]=e("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"Critiques",-1)),e("p",Be,c(a(v)?.totalReviews||0),1)]),l(d,{name:"heroicons:star",class:"w-8 h-8 text-yellow-500"})])]),e("div",Le,[e("div",ze,[e("div",null,[s[7]||(s[7]=e("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"Messages forum",-1)),e("p",Fe,c(a(n)?.nbPost||0),1)]),l(d,{name:"heroicons:chat-bubble-left",class:"w-8 h-8 text-purple-500"})])]),e("div",Ne,[e("div",Te,[e("div",null,[s[8]||(s[8]=e("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"Réputation",-1)),e("p",Ue,c(a(n)?.reputation||0),1)]),l(d,{name:"heroicons:trophy",class:"w-8 h-8 text-amber-500"})])]),e("div",Ee,[e("div",Pe,[e("div",null,[s[9]||(s[9]=e("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"Niveau",-1)),e("p",Ge,c(E()),1)]),l(d,{name:"heroicons:user-circle",class:"w-8 h-8 text-blue-500"})])])]),e("div",He,[e("div",Ke,[e("nav",Je,[(o(),i(_,null,w(L,r=>e("button",{key:r.id,onClick:b=>p.value=r.id,class:V([a(p)===r.id?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])},c(r.label),11,Oe)),64))])]),e("div",Qe,[$(e("div",We,[e("div",Xe,[s[11]||(s[11]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Critiques récentes",-1)),l(g,{to:`/user/${a(u)}/reviews`,class:"text-sm text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300"},{default:f(()=>s[10]||(s[10]=[m(" Voir toutes → ",-1)])),_:1,__:[10]},8,["to"])]),a(R).length?(o(),i("div",Ye,[(o(!0),i(_,null,w(a(R),r=>(o(),oe(de,{key:r.id||r.idCritique,review:H(r),onView:K},null,8,["review"]))),128))])):(o(),i("div",Ze," Aucune critique publiée "))],512),[[A,a(p)==="reviews"]]),$(e("div",et,[e("div",tt,[s[13]||(s[13]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Collections publiques",-1)),l(g,{to:`/collections/user/${a(n)?.id}`,class:"text-sm text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 flex items-center gap-2"},{default:f(()=>[l(d,{name:"heroicons:rectangle-stack",size:"xs"}),s[12]||(s[12]=m(" Voir toutes les collections → ",-1))]),_:1,__:[12]},8,["to"])]),a(k).length?(o(),i("div",st,[(o(!0),i(_,null,w(a(k),r=>(o(),i("div",{key:r.type,class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 border border-gray-200 dark:border-gray-600"},[e("div",rt,[e("div",{class:V(["w-4 h-4 rounded-full",N(r.type)])},null,2),e("span",at,c(r.totalCount)+" éléments",1)]),e("h4",ot,c(r.name),1),e("div",it,[e("div",nt,[l(d,{name:"heroicons:film",size:"xs"}),e("span",null,c(r.animeCount),1)]),e("div",lt,[l(d,{name:"heroicons:book-open",size:"xs"}),e("span",null,c(r.mangaCount),1)])]),l(g,{to:`/collections/user/${a(n)?.id}?type=${r.type}`,class:"mt-3 text-xs text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 flex items-center gap-1"},{default:f(()=>[s[14]||(s[14]=m(" Voir le détail ",-1)),l(d,{name:"heroicons:arrow-right",size:"xs"})]),_:2,__:[14]},1032,["to"])]))),128))])):(o(),i("div",dt,[l(d,{name:"heroicons:rectangle-stack",class:"w-12 h-12 mx-auto mb-3 opacity-50"}),s[15]||(s[15]=e("p",null,"Aucune collection publique",-1))]))],512),[[A,a(p)==="collections"]]),$(e("div",ct,[s[16]||(s[16]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Activité récente",-1)),a(D).length?(o(),i("div",ut,[(o(!0),i(_,null,w(a(D),r=>(o(),i("div",{key:r.id,class:"flex items-start space-x-4 p-4 border border-gray-200 dark:border-gray-700 rounded-lg"},[e("div",gt,[l(d,{name:P(r.type),class:"w-6 h-6 text-gray-500"},null,8,["name"])]),e("div",xt,[e("p",mt,c(G(r)),1),e("p",bt,c(T(r.date)),1)])]))),128))])):(o(),i("div",pt," Aucune activité récente publique "))],512),[[A,a(p)==="activity"]]),$(e("div",ht,[s[18]||(s[18]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white"},"Statistiques publiques",-1)),a(v)?.reviewStats?(o(),i("div",yt,[s[17]||(s[17]=e("h4",{class:"font-medium text-gray-900 dark:text-white mb-3"},"Distribution des notes de critiques",-1)),e("div",vt,[(o(!0),i(_,null,w(a(v).reviewStats,r=>(o(),i("div",{key:r.rating,class:"flex items-center justify-between"},[e("span",ft,c(r.rating)+"/10",1),e("div",_t,[e("div",wt,[e("div",{class:"bg-yellow-500 h-2 rounded-full",style:ie({width:`${r.count/Math.max(...a(v).reviewStats.map(b=>b.count))*100}%`})},null,4)]),e("span",kt,c(r.count),1)])]))),128))])])):C("",!0),s[19]||(s[19]=e("div",{class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4"},[e("h4",{class:"font-medium text-gray-900 dark:text-white mb-3"},"Activité mensuelle"),e("div",{class:"text-center py-4 text-gray-500 dark:text-gray-400"}," Graphique d'activité bientôt disponible ")],-1))],512),[[A,a(p)==="stats"]])])])]))])}}}),Dt=le(Ct,[["__scopeId","data-v-b52c0c44"]]);export{Dt as default};
