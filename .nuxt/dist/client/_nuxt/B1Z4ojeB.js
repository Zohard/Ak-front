import{f as K,v as L,g as d,x as H,H as Q,X,h as J,G as W,c,n as O,k as o,a as e,b as u,t as g,w as v,z as b,A as Y,K as P,F as T,l as $,D as Z,p as F,e as ee,r as z,o as i,d as R,m as te,u as re,_ as se}from"./Bes98wj2.js";import{u as oe}from"./BUcUzH0k.js";import{u as ae}from"./DBzy7ICT.js";import{u as le}from"./DKV7c2p8.js";const ne={class:"min-h-screen bg-gray-50 dark:bg-gray-900"},ie={key:0,class:"flex items-center justify-center py-12"},de={key:1,class:"container mx-auto px-4 py-8"},ce={class:"rounded-md bg-red-50 dark:bg-red-900/20 p-4"},ue={class:"flex"},ge={class:"ml-3"},me={class:"mt-2 text-sm text-red-700 dark:text-red-300"},pe={class:"mt-4 space-x-3"},xe={key:2},ye={class:"bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-700"},he={class:"max-w-7xl mx-auto px-6 md:px-8 lg:px-12 py-4"},ve={class:"flex items-center space-x-2 text-sm"},be={class:"text-gray-900 dark:text-white font-medium"},fe={class:"bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-gray-900 dark:to-gray-800 py-16"},_e={class:"max-w-7xl mx-auto px-6 md:px-8 lg:px-12"},ke={class:"text-center"},we={class:"text-4xl md:text-5xl font-bold text-gray-900 dark:text-white mb-4"},Ae={class:"text-lg md:text-xl text-gray-600 dark:text-gray-300 max-w-3xl mx-auto"},Ce={class:"mt-6 flex items-center justify-center space-x-4 text-sm text-gray-500 dark:text-gray-400"},Ie={class:"max-w-7xl mx-auto px-6 md:px-8 lg:px-12 py-12"},Be={class:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6 mb-8"},Oe={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Ve={class:"relative"},Ee=["value"],Me={class:"mt-4 flex flex-wrap items-center justify-between gap-4"},Ne={class:"flex items-center space-x-4"},De={class:"flex items-center space-x-2"},Pe={class:"text-sm text-gray-500 dark:text-gray-400"},Te={key:0,class:"mt-16 pt-8 border-t border-gray-200 dark:border-gray-700"},$e={class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"},Fe={class:"font-medium text-gray-900 dark:text-white group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors duration-200"},ze=K({__name:"[slug]",setup(Re){const f=L(),p=f.params.slug,l=d(null),V=d([]),E=d([]),_=d([]),k=d(!0),w=d(!1),x=d(""),A=d(0),M=d(),s=H({page:1,limit:12,search:"",authorId:void 0,sortBy:"date",sortOrder:"desc"}),S=oe(),C=ae(),y=Q(()=>!!(s.search||s.authorId||s.sortBy!=="date")),I=async()=>{try{k.value=!0,x.value="";let r;isNaN(Number(p))?r=await C.fetchCategoryBySlug(p):r=await C.fetchCategoryById(Number(p)),l.value=r,await Promise.allSettled([B(),U()])}catch(r){x.value="Catégorie non trouvée",console.error("Error loading category:",r)}finally{k.value=!1}},B=async()=>{if(l.value)try{w.value=!0;const r=await S.fetchArticlesByCategory(l.value.id,{...s,sortOrder:s.sortOrder==="desc"?"desc":"asc"});V.value=r.articles,M.value=r.pagination,A.value=r.pagination.totalItems;const t=new Map;r.articles.forEach(n=>{n.author&&!t.has(n.author.idMember)&&t.set(n.author.idMember,n.author)}),E.value=Array.from(t.values())}catch(r){console.error("Error loading category articles:",r)}finally{w.value=!1}},U=async()=>{try{const r=await C.fetchCategories();_.value=r.filter(t=>t.id!==l.value?.id).slice(0,8)}catch(r){console.error("Error loading other categories:",r)}},m=()=>{s.page=1,B();const r={};s.search&&(r.search=s.search),s.authorId&&(r.author=s.authorId.toString()),s.sortBy!=="date"&&(r.sort=s.sortBy),s.sortOrder!=="desc"&&(r.order=s.sortOrder),F({query:r},{replace:!0})},N=le(()=>{m()},500),D=()=>{s.search="",s.authorId=void 0,s.sortBy="date",s.sortOrder="desc",m()},j=r=>{s.page=r,B(),window.scrollTo({top:0,behavior:"smooth"})},q=r=>{F(`/articles/${r.niceUrl}`)};return X(()=>{l.value&&re({title:`${l.value.name} - Articles - Anime-Kun V2`,meta:[{name:"description",content:`Découvrez tous les articles de la catégorie "${l.value.name}" sur Anime-Kun V2`},{name:"keywords",content:`${l.value.name}, articles, anime, manga`},{property:"og:title",content:`${l.value.name} - Articles`},{property:"og:description",content:`Découvrez tous les articles de la catégorie "${l.value.name}"`},{property:"og:type",content:"website"}]})}),J(()=>{const r=f.query;r.search&&(s.search=r.search),r.author&&(s.authorId=parseInt(r.author)),r.sort&&(s.sortBy=r.sort),r.order&&(s.sortOrder=r.order),r.page&&(s.page=parseInt(r.page)||1),I()}),W(()=>f.params.slug,r=>{r&&r!==p&&I()}),(r,t)=>{const n=z("Icon"),h=ee,G=z("ArticleCardGrid");return i(),c("div",ne,[o(k)?(i(),c("div",ie,t[5]||(t[5]=[e("div",{class:"animate-spin rounded-full h-8 w-8 border-2 border-blue-500 border-t-transparent"},null,-1),e("span",{class:"ml-3 text-gray-600 dark:text-gray-300"},"Chargement de la catégorie...",-1)]))):o(x)?(i(),c("div",de,[e("div",ce,[e("div",ue,[u(n,{name:"heroicons:exclamation-triangle",class:"h-5 w-5 text-red-400"}),e("div",ge,[t[7]||(t[7]=e("h3",{class:"text-sm font-medium text-red-800 dark:text-red-200"}," Catégorie non trouvée ",-1)),e("div",me,g(o(x)),1),e("div",pe,[u(h,{to:"/articles",class:"btn-primary"},{default:v(()=>t[6]||(t[6]=[R(" Retour aux articles ",-1)])),_:1,__:[6]}),e("button",{onClick:I,class:"btn-secondary"}," Réessayer ")])])])])])):o(l)?(i(),c("div",xe,[e("nav",ye,[e("div",he,[e("ol",ve,[e("li",null,[u(h,{to:"/",class:"text-gray-500 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 transition-colors duration-200"},{default:v(()=>[u(n,{name:"heroicons:home",class:"w-4 h-4"})]),_:1})]),e("li",null,[u(n,{name:"heroicons:chevron-right",class:"w-4 h-4 text-gray-400"})]),e("li",null,[u(h,{to:"/articles",class:"text-gray-500 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 transition-colors duration-200"},{default:v(()=>t[8]||(t[8]=[R(" Articles ",-1)])),_:1,__:[8]})]),e("li",null,[u(n,{name:"heroicons:chevron-right",class:"w-4 h-4 text-gray-400"})]),e("li",null,[e("span",be,g(o(l).name),1)])])])]),e("header",fe,[e("div",_e,[e("div",ke,[e("h1",we,g(o(l).name),1),e("p",Ae,' Découvrez tous les articles de la catégorie "'+g(o(l).name)+'" ',1),e("div",Ce,[e("span",null,g(o(A))+" articles",1),t[9]||(t[9]=e("span",null,"•",-1)),t[10]||(t[10]=e("span",null,"Mis à jour régulièrement",-1))])])])]),e("main",Ie,[e("div",Be,[e("div",Oe,[e("div",null,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Recherche dans cette catégorie ",-1)),e("div",Ve,[b(e("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>o(s).search=a),type:"text",placeholder:"Rechercher un article...",class:"form-input pl-10",onInput:t[1]||(t[1]=(...a)=>o(N)&&o(N)(...a))},null,544),[[Y,o(s).search]]),u(n,{name:"heroicons:magnifying-glass",class:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"})])]),e("div",null,[t[13]||(t[13]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Auteur ",-1)),b(e("select",{"onUpdate:modelValue":t[2]||(t[2]=a=>o(s).authorId=a),class:"form-input",onChange:m},[t[12]||(t[12]=e("option",{value:""},"Tous les auteurs",-1)),(i(!0),c(T,null,$(o(E),a=>(i(),c("option",{key:a.idMember,value:a.idMember},g(a.memberName),9,Ee))),128))],544),[[P,o(s).authorId]])]),e("div",null,[t[15]||(t[15]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Trier par ",-1)),b(e("select",{"onUpdate:modelValue":t[3]||(t[3]=a=>o(s).sortBy=a),class:"form-input",onChange:m},t[14]||(t[14]=[e("option",{value:"date"},"Date de publication",-1),e("option",{value:"titre"},"Titre",-1),e("option",{value:"nbClics"},"Popularité",-1),e("option",{value:"commentCount"},"Commentaires",-1)]),544),[[P,o(s).sortBy]])])]),e("div",Me,[e("div",Ne,[e("div",De,[b(e("input",{id:"sortOrder","onUpdate:modelValue":t[4]||(t[4]=a=>o(s).sortOrder=a),type:"checkbox",class:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded",onChange:m},null,544),[[Z,o(s).sortOrder]]),t[16]||(t[16]=e("label",{for:"sortOrder",class:"text-sm text-gray-700 dark:text-gray-300"}," Ordre décroissant ",-1))]),o(y)?(i(),c("button",{key:0,onClick:D,class:"text-sm text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 transition-colors duration-200"}," Effacer les filtres ")):O("",!0)]),e("div",Pe,g(o(A))+" articles trouvés ",1)])]),u(G,{articles:o(V),loading:o(w),pagination:o(M),"empty-title":o(y)?"Aucun article trouvé":"Aucun article dans cette catégorie","empty-message":o(y)?"Essayez de modifier vos filtres de recherche.":"Cette catégorie ne contient pas encore d'articles.","show-empty-action":o(y),"empty-action-text":"Effacer les filtres","grid-cols":"auto",gap:"lg",onArticleView:q,onPageChange:j,onEmptyAction:D},null,8,["articles","loading","pagination","empty-title","empty-message","show-empty-action"]),o(_).length>0?(i(),c("section",Te,[t[17]||(t[17]=e("h2",{class:"text-2xl font-bold text-gray-900 dark:text-white mb-8 text-center"}," Autres catégories ",-1)),e("div",$e,[(i(!0),c(T,null,$(o(_),a=>(i(),te(h,{key:a.id,to:`/articles/category/${a.slug||a.id}`,class:"p-4 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 hover:border-blue-300 dark:hover:border-blue-600 hover:shadow-md transition-all duration-200 text-center group"},{default:v(()=>[e("h3",Fe,g(a.name),1)]),_:2},1032,["to"]))),128))])])):O("",!0)])])):O("",!0)])}}}),Ge=se(ze,[["__scopeId","data-v-edd6b900"]]);export{Ge as default};
