import C from"./BSmumdHB.js";import{u as q}from"./DMFesj3P.js";import{f as T,g as u,h as M,c as i,a as r,F as b,l as v,k as l,d as R,t as p,o as a,B,m as A,_ as I}from"./Bes98wj2.js";import"./azFSasi8.js";import"./DzvRhcSF.js";const V={class:"top-reviews bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6"},N={class:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-4"},j={class:"inline-flex rounded-md shadow-sm",role:"group"},z=["onClick"],D={key:0,class:"flex items-center justify-center py-8 text-gray-600 dark:text-gray-300"},E={key:1,class:"rounded-md bg-red-50 dark:bg-red-900/20 p-4 mb-4 text-red-700 dark:text-red-300"},F={key:2},L={key:0,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6"},P={key:1,class:"text-center py-8 text-gray-600 dark:text-gray-300"},U=T({__name:"TopReviews",props:{limit:{default:6},defaultType:{default:"both"}},setup(y){const m=y,{getTopReviews:f,fetchReviews:k}=q(),c=u(!1),d=u(""),o=u(m.defaultType),n=u([]),x=[{label:"Tous",value:"both"},{label:"Anime",value:"anime"},{label:"Manga",value:"manga"}],g=async()=>{try{c.value=!0,d.value="";const{data:e}=await f(m.limit,"week",o.value);if(n.value=e||[],!n.value.length){const s={limit:m.limit,sortBy:"nbClics",sortOrder:"desc",statut:0};o.value==="anime"&&(s.type="anime"),o.value==="manga"&&(s.type="manga");const t=await k(s);n.value=t?.data||[]}}catch(e){d.value=e?.message||"Erreur lors du chargement des meilleures critiques",n.value=[]}finally{c.value=!1}},h=e=>{o.value!==e&&(o.value=e,g())},_=e=>({idCritique:e.idCritique||e.id,niceUrl:e.niceUrl,titre:e.titre,critique:e.critique||e.contenu,notation:e.notation||e.note,dateCritique:e.reviewDate||e.dateCritique||e.dateCreation,statut:typeof e.statut=="number"?e.statut:1,idMembre:e.idMembre||e.userId||0,idAnime:e.idAnime||e.animeId||0,idManga:e.idManga||e.mangaId||0,nbClics:e.nbClics||e.nbVues||0,anime:e.anime,manga:e.manga,membre:e.membre?{id:e.membre.id||e.membre.idMember,pseudo:e.membre.pseudo||e.membre.memberName,avatar:e.membre.avatar}:void 0}),w=e=>{};return M(g),(e,s)=>(a(),i("section",V,[r("div",N,[s[0]||(s[0]=r("div",null,[r("h2",{class:"text-xl font-semibold text-gray-900 dark:text-white"},"Top critiques"),r("p",{class:"text-sm text-gray-600 dark:text-gray-300"},"Les critiques les plus utiles et populaires")],-1)),r("div",j,[(a(),i(b,null,v(x,t=>r("button",{key:t.value,type:"button",class:B(["px-4 py-2 text-sm font-medium border",l(o)===t.value?"bg-blue-600 text-white border-blue-600":"bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700"]),onClick:O=>h(t.value)},p(t.label),11,z)),64))])]),l(c)?(a(),i("div",D,s[1]||(s[1]=[r("div",{class:"animate-spin rounded-full h-6 w-6 border-2 border-blue-500 border-t-transparent mr-3"},null,-1),R(" Chargement des meilleures critiques... ",-1)]))):l(d)?(a(),i("div",E,p(l(d)),1)):(a(),i("div",F,[l(n).length?(a(),i("div",L,[(a(!0),i(b,null,v(l(n),t=>(a(),A(C,{key:t.idCritique||t.id,review:_(t),onView:w},null,8,["review"]))),128))])):(a(),i("div",P," Aucune critique trouv√©e. "))]))]))}}),K=I(U,[["__scopeId","data-v-6172ef8c"]]);export{K as default};
