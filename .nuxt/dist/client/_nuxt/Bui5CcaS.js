import{f as se,v as ae,H as y,u as oe,q as ne,g as v,I as re,G as F,i as ie,c as a,n as g,k as r,a as t,b as i,w as C,B as E,t as d,d as m,F as L,l as R,r as P,e as le,j as ce,o,y as H,p as B,_ as de}from"./Bes98wj2.js";import{u as ge}from"./CgwEqSHp.js";import{u as me}from"./DzvRhcSF.js";import{u as ue}from"./DuWR0lLf.js";import"./BJ2ClxiI.js";const xe={class:"main-content"},he={key:0,class:"flex items-center justify-center py-12"},pe={key:1,class:"text-center py-12"},ye={class:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-700 rounded-lg p-6 max-w-md mx-auto"},ve={key:2},_e={class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-8 mb-8"},fe={class:"flex items-start justify-between"},be={class:"flex items-start gap-4"},ke={class:"flex-1"},we={class:"text-2xl font-bold text-gray-900 dark:text-white mb-2"},Ce={class:"flex items-center gap-4 text-sm text-gray-600 dark:text-gray-400 mb-3"},Ae={class:"flex items-center gap-1"},Ie={class:"flex items-center gap-1"},ze={key:0,class:"flex items-center gap-1"},je={class:"flex items-center gap-1"},$e={key:0,class:"text-gray-600 dark:text-gray-400 leading-relaxed"},Ee={key:0,class:"flex items-center gap-2"},Be={class:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-1 mb-8"},Ue={class:"flex space-x-1"},Me={class:"flex items-center justify-center gap-2"},Ne={class:"flex items-center justify-center gap-2"},De={key:0},Fe={key:0,class:"flex items-center justify-center py-12"},Le={key:1,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"},Re=["onClick"],Pe={class:"relative"},He={class:"aspect-[3/4] overflow-hidden"},Se=["src","alt"],Ve={key:1,class:"w-full h-full bg-gradient-to-br from-blue-100 to-blue-200 dark:from-blue-900 dark:to-blue-800 flex flex-col items-center justify-center p-4"},Te={class:"text-center"},qe={class:"text-sm font-medium text-blue-700 dark:text-blue-300 mb-1"},Ke={key:0,class:"absolute top-3 right-3 bg-black/70 backdrop-blur-sm text-white px-2 py-1 rounded-full text-xs font-semibold flex items-center gap-1"},Ge={key:1,class:"absolute top-3 left-3 opacity-0 group-hover:opacity-100 transition-opacity"},Oe={class:"p-4 space-y-3"},Je={class:"font-semibold text-lg text-gray-900 dark:text-white line-clamp-2 leading-tight"},Qe={class:"flex items-center gap-3 text-sm text-gray-600 dark:text-gray-400"},We={key:0,class:"flex items-center gap-1"},Xe={key:1,class:"flex items-center gap-1"},Ye={key:0,class:"pt-2 border-t border-gray-200 dark:border-gray-700"},Ze={key:0,class:"flex items-center gap-1 mb-1"},et={class:"text-sm font-medium"},tt={key:1,class:"text-xs text-gray-600 dark:text-gray-400 line-clamp-2"},st={class:"text-xs text-gray-500 dark:text-gray-400"},at={key:2,class:"text-center py-12"},ot={key:1},nt={key:0,class:"flex items-center justify-center py-12"},rt={key:1,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"},it=["onClick"],lt={class:"relative"},ct={class:"aspect-[3/4] overflow-hidden"},dt=["src","alt"],gt={key:1,class:"w-full h-full bg-gradient-to-br from-green-100 to-green-200 dark:from-green-900 dark:to-green-800 flex flex-col items-center justify-center p-4"},mt={class:"text-center"},ut={class:"text-sm font-medium text-green-700 dark:text-green-300 mb-1"},xt={key:0,class:"absolute top-3 left-3 opacity-0 group-hover:opacity-100 transition-opacity"},ht={class:"p-4 space-y-3"},pt={class:"font-semibold text-lg text-gray-900 dark:text-white line-clamp-2 leading-tight"},yt={class:"flex items-center gap-3 text-sm text-gray-600 dark:text-gray-400"},vt={key:0,class:"flex items-center gap-1"},_t={key:1,class:"flex items-center gap-1"},ft={key:0,class:"pt-2 border-t border-gray-200 dark:border-gray-700"},bt={key:0,class:"flex items-center gap-1 mb-1"},kt={class:"text-sm font-medium"},wt={key:1,class:"text-xs text-gray-600 dark:text-gray-400 line-clamp-2"},Ct={class:"text-xs text-gray-500 dark:text-gray-400"},At={key:2,class:"text-center py-12"},It=se({__name:"[id]",async setup(zt){let _,U;const S=ae(),M=parseInt(S.params.id),V=y(()=>{try{return l.value?`${l.value.name} - Collections`:"Collection - Anime-Kun"}catch{return"Collection - Anime-Kun"}}),T=y(()=>{try{return l.value?.description||"Collection d'animes et mangas"}catch{return"Collection d'animes et mangas"}});oe({title:V,meta:[{name:"description",content:T}]});const f=ne(),b=ge(),{getImageUrl:N,handleImageError:D}=me(),h=v("animes"),u=v([]),x=v([]),k=v(!1),w=v(!1),{data:q,pending:K,error:G}=([_,U]=re(()=>ue(`/api/collections/${M}`,{baseURL:ce().public.apiBase,headers:y(()=>f.isAuthenticated?f.getAuthHeaders():{}),key:`collection-${M}`},"$LynHuDl0IB")),_=await _,U(),_),l=y(()=>{try{return q.value?.collection||null}catch{return null}}),A=y(()=>{try{return f.isAuthenticated&&l.value&&f.user?.id===l.value.userId}catch{return!1}}),O=y(()=>{try{return u.value.length+x.value.length}catch{return 0}}),I=n=>new Date(n).toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"}),J=n=>{const e=["bg-purple-600","bg-blue-600","bg-green-600","bg-red-600","bg-yellow-600","bg-indigo-600","bg-pink-600","bg-orange-600"];return e[n.id%e.length]},Q=n=>{const e=["heroicons:star","heroicons:heart","heroicons:bookmark","heroicons:film","heroicons:book-open","heroicons:trophy","heroicons:fire","heroicons:sparkles"];return e[n.id%e.length]},z=async()=>{if(l.value){k.value=!0;try{const n=await b.fetchCollectionAnimes(l.value.id);u.value=n.data||n.animes||[]}catch(n){console.error("Error loading collection animes:",n),u.value=[]}finally{k.value=!1}}},j=async()=>{if(l.value){w.value=!0;try{const n=await b.fetchCollectionMangas(l.value.id);x.value=n.data||n.mangas||[]}catch(n){console.error("Error loading collection mangas:",n),x.value=[]}finally{w.value=!1}}},W=n=>{if(!n)return;const e=`/anime/${n.niceUrl||n.id}`;B(e)},X=n=>{if(!n)return;const e=`/manga/${n.niceUrl||n.id}`;B(e)},Y=async n=>{if(!(!l.value||!confirm("Retirer cet anime de la collection ?")))try{await b.removeAnimeFromCollection(l.value.id,n.animeId),await z()}catch(e){console.error("Error removing anime:",e)}},Z=async n=>{if(!(!l.value||!confirm("Retirer ce manga de la collection ?")))try{await b.removeMangaFromCollection(l.value.id,n.mangaId),await j()}catch(e){console.error("Error removing manga:",e)}},ee=()=>{B("/my-collections")};return F(l,async n=>{n&&await Promise.all([z(),j()])},{immediate:!0}),F(h,async n=>{n==="animes"&&u.value.length===0?await z():n==="mangas"&&x.value.length===0&&await j()}),ie(()=>{u.value=[],x.value=[],k.value=!1,w.value=!1}),(n,e)=>{const c=P("Icon"),te=le,$=P("Button");return o(),a("div",xe,[r(K)?(o(),a("div",he,e[4]||(e[4]=[t("div",{class:"animate-spin rounded-full h-8 w-8 border-2 border-purple-500 border-t-transparent"},null,-1),t("span",{class:"ml-3 text-gray-600 dark:text-gray-300"},"Chargement de la collection...",-1)]))):r(G)?(o(),a("div",pe,[t("div",ye,[i(c,{name:"heroicons:exclamation-triangle",class:"w-8 h-8 text-red-500 mx-auto mb-3"}),e[6]||(e[6]=t("h3",{class:"text-lg font-medium text-red-800 dark:text-red-200 mb-2"},"Collection non trouvée",-1)),e[7]||(e[7]=t("p",{class:"text-red-600 dark:text-red-300 text-sm mb-4"}," Cette collection n'existe pas ou n'est pas accessible ",-1)),i(te,{to:"/my-collections",class:"btn-secondary"},{default:C(()=>e[5]||(e[5]=[m(" Retour aux collections ",-1)])),_:1,__:[5]})])])):r(l)?(o(),a("div",ve,[t("div",_e,[t("div",fe,[t("div",be,[t("div",{class:E(["w-16 h-16 rounded-xl flex items-center justify-center flex-shrink-0",J(r(l))])},[i(c,{name:Q(r(l)),size:"lg",class:"text-white"},null,8,["name"])],2),t("div",ke,[t("h1",we,d(r(l).name),1),t("div",Ce,[t("span",Ae,[i(c,{name:"heroicons:user",size:"xs"}),m(" "+d(r(l).user?.pseudo||"Utilisateur"),1)]),t("span",Ie,[i(c,{name:"heroicons:calendar",size:"xs"}),m(" "+d(I(r(l).createdAt)),1)]),r(l).isPublic?(o(),a("span",ze,[i(c,{name:"heroicons:globe-alt",size:"xs"}),e[8]||(e[8]=m(" Public ",-1))])):g("",!0),t("span",je,[i(c,{name:"heroicons:rectangle-stack",size:"xs"}),m(" "+d(r(O))+" éléments ",1)])]),r(l).description?(o(),a("p",$e,d(r(l).description),1)):g("",!0)])]),r(A)?(o(),a("div",Ee,[i($,{onClick:ee,variant:"secondary",size:"sm"},{default:C(()=>[i(c,{name:"heroicons:pencil-square",size:"xs",class:"mr-2"}),e[9]||(e[9]=m(" Modifier ",-1))]),_:1,__:[9]})])):g("",!0)])]),t("div",Be,[t("div",Ue,[t("button",{onClick:e[0]||(e[0]=s=>h.value="animes"),class:E(["flex-1 px-4 py-3 text-sm font-medium rounded-md transition-colors duration-200",r(h)==="animes"?"bg-blue-600 text-white shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 hover:bg-gray-100 dark:hover:bg-gray-700"])},[t("div",Me,[i(c,{name:"heroicons:film",size:"sm"}),m(" Animes ("+d(r(u).length)+") ",1)])],2),t("button",{onClick:e[1]||(e[1]=s=>h.value="mangas"),class:E(["flex-1 px-4 py-3 text-sm font-medium rounded-md transition-colors duration-200",r(h)==="mangas"?"bg-green-600 text-white shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 hover:bg-gray-100 dark:hover:bg-gray-700"])},[t("div",Ne,[i(c,{name:"heroicons:book-open",size:"sm"}),m(" Mangas ("+d(r(x).length)+") ",1)])],2)])]),r(h)==="animes"?(o(),a("div",De,[r(k)?(o(),a("div",Fe,e[10]||(e[10]=[t("div",{class:"animate-spin rounded-full h-6 w-6 border-2 border-blue-500 border-t-transparent"},null,-1),t("span",{class:"ml-3 text-gray-600 dark:text-gray-300"},"Chargement des animes...",-1)]))):r(u).length?(o(),a("div",Le,[(o(!0),a(L,null,R(r(u),s=>(o(),a("div",{key:s.id,class:"group relative bg-white dark:bg-gray-800 rounded-xl overflow-hidden shadow-lg hover:shadow-xl transition-all duration-300 hover:-translate-y-1 cursor-pointer",onClick:p=>W(s.anime)},[t("div",Pe,[t("div",He,[s.anime?.image?(o(),a("img",{key:0,src:r(N)(s.anime.image,"anime"),alt:s.anime.titre,class:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-105",loading:"lazy",onError:e[2]||(e[2]=p=>r(D)(p,void 0,"anime"))},null,40,Se)):(o(),a("div",Ve,[i(c,{name:"heroicons:film",class:"w-16 h-16 text-blue-500 dark:text-blue-400 mb-3"}),t("div",Te,[t("p",qe,d(s.anime?.titre),1),e[11]||(e[11]=t("p",{class:"text-xs text-blue-600 dark:text-blue-400"},"Image bientôt disponible",-1))])]))]),s.anime?.moyenneNotes&&s.anime.moyenneNotes>0?(o(),a("div",Ke,[i(c,{name:"heroicons:star",class:"w-3 h-3 text-yellow-400"}),t("span",null,d(s.anime.moyenneNotes.toFixed(1)),1)])):g("",!0),r(A)?(o(),a("div",Ge,[i($,{onClick:H(p=>Y(s),["stop"]),variant:"danger",size:"sm",class:"bg-red-600/90 hover:bg-red-700/90 backdrop-blur-sm"},{default:C(()=>[i(c,{name:"heroicons:trash",size:"xs"})]),_:2},1032,["onClick"])])):g("",!0)]),t("div",Oe,[t("h3",Je,d(s.anime?.titre),1),t("div",Qe,[s.anime?.annee?(o(),a("span",We,[i(c,{name:"heroicons:calendar",class:"w-3 h-3"}),m(" "+d(s.anime.annee),1)])):g("",!0),s.anime?.nbEp?(o(),a("span",Xe,[i(c,{name:"heroicons:film",class:"w-3 h-3"}),m(" "+d(s.anime.nbEp)+" ép. ",1)])):g("",!0)]),s.notes||s.rating?(o(),a("div",Ye,[s.rating?(o(),a("div",Ze,[i(c,{name:"heroicons:star",class:"w-3 h-3 text-yellow-500"}),t("span",et,d(s.rating)+"/10",1)])):g("",!0),s.notes?(o(),a("p",tt,d(s.notes),1)):g("",!0)])):g("",!0),t("div",st," Ajouté le "+d(I(s.addedAt)),1)])],8,Re))),128))])):(o(),a("div",at,[i(c,{name:"heroicons:film",class:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e[12]||(e[12]=t("h3",{class:"text-lg font-medium text-gray-900 dark:text-white mb-2"},"Aucun anime",-1)),e[13]||(e[13]=t("p",{class:"text-gray-500 dark:text-gray-400"}," Cette collection ne contient pas encore d'animes ",-1))]))])):g("",!0),r(h)==="mangas"?(o(),a("div",ot,[r(w)?(o(),a("div",nt,e[14]||(e[14]=[t("div",{class:"animate-spin rounded-full h-6 w-6 border-2 border-green-500 border-t-transparent"},null,-1),t("span",{class:"ml-3 text-gray-600 dark:text-gray-300"},"Chargement des mangas...",-1)]))):r(x).length?(o(),a("div",rt,[(o(!0),a(L,null,R(r(x),s=>(o(),a("div",{key:s.id,class:"group relative bg-white dark:bg-gray-800 rounded-xl overflow-hidden shadow-lg hover:shadow-xl transition-all duration-300 hover:-translate-y-1 cursor-pointer",onClick:p=>X(s.manga)},[t("div",lt,[t("div",ct,[s.manga?.image?(o(),a("img",{key:0,src:r(N)(s.manga.image,"manga"),alt:s.manga.titre,class:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-105",loading:"lazy",onError:e[3]||(e[3]=p=>r(D)(p,void 0,"manga"))},null,40,dt)):(o(),a("div",gt,[i(c,{name:"heroicons:book-open",class:"w-16 h-16 text-green-500 dark:text-green-400 mb-3"}),t("div",mt,[t("p",ut,d(s.manga?.titre),1),e[15]||(e[15]=t("p",{class:"text-xs text-green-600 dark:text-green-400"},"Image bientôt disponible",-1))])]))]),r(A)?(o(),a("div",xt,[i($,{onClick:H(p=>Z(s),["stop"]),variant:"danger",size:"sm",class:"bg-red-600/90 hover:bg-red-700/90 backdrop-blur-sm"},{default:C(()=>[i(c,{name:"heroicons:trash",size:"xs"})]),_:2},1032,["onClick"])])):g("",!0)]),t("div",ht,[t("h3",pt,d(s.manga?.titre),1),t("div",yt,[s.manga?.annee?(o(),a("span",vt,[i(c,{name:"heroicons:calendar",class:"w-3 h-3"}),m(" "+d(s.manga.annee),1)])):g("",!0),s.manga?.auteur?(o(),a("span",_t,[i(c,{name:"heroicons:user",class:"w-3 h-3"}),m(" "+d(s.manga.auteur),1)])):g("",!0)]),s.notes||s.rating?(o(),a("div",ft,[s.rating?(o(),a("div",bt,[i(c,{name:"heroicons:star",class:"w-3 h-3 text-yellow-500"}),t("span",kt,d(s.rating)+"/10",1)])):g("",!0),s.notes?(o(),a("p",wt,d(s.notes),1)):g("",!0)])):g("",!0),t("div",Ct," Ajouté le "+d(I(s.addedAt)),1)])],8,it))),128))])):(o(),a("div",At,[i(c,{name:"heroicons:book-open",class:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e[16]||(e[16]=t("h3",{class:"text-lg font-medium text-gray-900 dark:text-white mb-2"},"Aucun manga",-1)),e[17]||(e[17]=t("p",{class:"text-gray-500 dark:text-gray-400"}," Cette collection ne contient pas encore de mangas ",-1))]))])):g("",!0)])):g("",!0)])}}}),Mt=de(It,[["__scopeId","data-v-e244b20a"]]);export{Mt as default};
