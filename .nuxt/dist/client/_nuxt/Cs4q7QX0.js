import{u as T}from"./BUUJWTKH.js";import{u as D}from"./DzvRhcSF.js";import{f as H,g as m,H as L,h as M,Y as N,G as R,c as o,k as s,t as u,a as n,n as h,F as A,l as C,p as I,o as l,B as $}from"./Bes98wj2.js";import{s as B}from"./x_rD_Ya3.js";const V={class:"hero-carousel"},F={key:0,class:"loading"},j={key:1,class:"error"},G={key:2,class:"carousel-container"},O={class:"carousel-slide"},Y=["src","alt"],q={class:"hero-content"},J={class:"anime-meta"},K={class:"anime-year"},Q={key:0,class:"anime-episodes"},W={class:"hero-title"},X={class:"hero-subtitle"},Z={class:"carousel-dots"},x=["onClick","aria-label"],ee={class:"carousel-thumbnails"},se=["onClick"],ne=["src","alt"],te={class:"thumbnail-overlay"},ae={class:"thumbnail-title"},ue=H({__name:"HeroBanner",setup(oe){const{fetchAnimes:E}=T(),{getImageUrl:p}=D(),t=m([]),r=m(0),_=m(!0),g=m("Component loaded"),a=L(()=>t.value[r.value]||{}),P=async()=>{console.log("fetchRecentAnimes function called!");try{console.log("Making API call with fetchAnimes...");const e=await E({limit:5,sortBy:"dateAjout",sortOrder:"desc"});console.log("API response received:",e),e&&e.animes&&e.animes.length>0?(t.value=e.animes,console.log("Animes set, length:",t.value.length)):console.log("No animes in response or invalid response structure")}catch(e){console.error("Error fetching recent animes:",e)}finally{_.value=!1,console.log("Loading set to false")}},v=()=>{r.value=(r.value+1)%t.value.length},S=()=>{r.value=(r.value-1+t.value.length)%t.value.length},f=e=>{r.value=e},U=e=>e?e.length>200?e.substring(0,200)+"...":e:"Découvrez cet anime passionnant",y=e=>{e.target.style.display="none"},w=e=>e.toLowerCase().replace(/[àáâãäå]/g,"a").replace(/[èéêë]/g,"e").replace(/[ìíîï]/g,"i").replace(/[òóôõö]/g,"o").replace(/[ùúûü]/g,"u").replace(/[ýÿ]/g,"y").replace(/[ñ]/g,"n").replace(/[ç]/g,"c").replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,""),b=()=>{if(a.value.niceUrl){const e=a.value.niceUrl||w(a.value.titre);I(`/anime/${e}-${a.value.id}`)}else I("/animes")};let d=null;return M(async()=>{console.log("HeroBanner component mounted, starting API call..."),g.value="Component mounted!",await P(),console.log("API call completed, animes length:",t.value.length),g.value=`API done, ${t.value.length} animes`,t.value.length>0&&(d=B(()=>{v()},5e3))}),N(()=>{d&&clearInterval(d)}),R(()=>t.value.length,e=>{e>0&&!d&&(d=B(()=>{v()},5e3))}),(e,k)=>(l(),o("div",V,[s(_)?(l(),o("div",F," Chargement des animes récents... "+u(s(g)),1)):s(t).length===0?(l(),o("div",j," Aucun anime trouvé ")):(l(),o("div",G,[n("div",O,[s(a).image?(l(),o("img",{key:0,src:s(p)(s(a).image)||"",alt:`Image de l'anime ${s(a).titre}`,class:"hero-image",loading:"eager",onError:y},null,40,Y)):h("",!0),k[0]||(k[0]=n("div",{class:"hero-overlay"},null,-1)),n("div",q,[n("div",J,[n("span",K,u(s(a).annee),1),s(a).nbEp?(l(),o("span",Q,u(s(a).nbEp)+" épisodes",1)):h("",!0)]),n("h1",W,u(s(a).titre),1),n("p",X,u(U(s(a).synopsis)),1),n("div",{class:"hero-actions"},[n("button",{class:"hero-button primary",onClick:b}," Découvrir "),n("button",{class:"hero-button secondary",onClick:b}," Voir la fiche ")])])]),n("button",{class:"carousel-nav prev",onClick:S,"aria-label":"Anime précédent"}," ‹ "),n("button",{class:"carousel-nav next",onClick:v,"aria-label":"Anime suivant"}," › "),n("div",Z,[(l(!0),o(A,null,C(s(t),(i,c)=>(l(),o("button",{key:c,class:$(["dot",{active:c===s(r)}]),onClick:z=>f(c),"aria-label":`Aller à l'anime ${c+1}`},null,10,x))),128))]),n("div",ee,[(l(!0),o(A,null,C(s(t),(i,c)=>(l(),o("div",{key:i.id,class:$(["thumbnail",{active:c===s(r)}]),onClick:z=>f(c)},[i.image?(l(),o("img",{key:0,src:s(p)(i.image||"","anime")||void 0,alt:i.titre,loading:"lazy",onError:y},null,40,ne)):h("",!0),n("div",te,[n("span",ae,u(i.titre),1)])],10,se))),128))])]))]))}});export{ue as default};
