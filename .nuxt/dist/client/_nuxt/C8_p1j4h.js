import{f as R,g,H as C,h as I,Y as q,c as p,a as u,n as z,k as n,N as H,o as m,_ as B}from"./Bes98wj2.js";/* empty css        */const L={class:"review-content"},M=["innerHTML"],P={key:0,class:"fixed top-0 left-0 w-full h-1 bg-gray-200 dark:bg-gray-700 z-50"},E=R({__name:"ReviewContent",props:{content:{default:""},showReadingProgress:{type:Boolean,default:!1},enableImageModal:{type:Boolean,default:!0}},emits:["image-click"],setup(b,{emit:w}){const a=b,h=w,c=g(),t=g(0),f=C(()=>{if(!a.content)return'<p class="text-gray-500 italic">Aucun contenu disponible.</p>';let e=a.content;return e=k(e),e=$(e),e=v(e),e=y(e),e=x(e),e}),k=e=>(e=e.replace(/\[b\](.*?)\[\/b\]/gi,"<strong>$1</strong>"),e=e.replace(/\[i\](.*?)\[\/i\]/gi,"<em>$1</em>"),e=e.replace(/\[u\](.*?)\[\/u\]/gi,"<u>$1</u>"),e=e.replace(/\[size=(\d+)\](.*?)\[\/size\]/gi,'<span style="font-size: $1px">$2</span>'),e=e.replace(/\[color=([^\]]+)\](.*?)\[\/color\]/gi,'<span style="color: $1">$2</span>'),e=e.replace(/\[quote\](.*?)\[\/quote\]/gi,'<blockquote class="border-l-4 border-blue-500 bg-blue-50 dark:bg-blue-900/20 pl-4 py-2 my-4 italic rounded-r-lg">$1</blockquote>'),e=e.replace(/\[quote=([^\]]+)\](.*?)\[\/quote\]/gi,'<blockquote class="border-l-4 border-blue-500 bg-blue-50 dark:bg-blue-900/20 pl-4 py-2 my-4 rounded-r-lg"><cite class="font-semibold not-italic text-blue-700 dark:text-blue-300">$1 a dit :</cite><br><span class="italic">$2</span></blockquote>'),e=e.replace(/\[code\](.*?)\[\/code\]/gi,'<pre class="bg-gray-100 dark:bg-gray-800 p-4 rounded-md overflow-x-auto my-4"><code>$1</code></pre>'),e=e.replace(/\[list\](.*?)\[\/list\]/gi,'<ul class="list-disc list-inside my-4 space-y-1">$1</ul>'),e=e.replace(/\[\*\](.*?)(?=\[\*\]|\[\/list\]|$)/gi,'<li class="ml-2">$1</li>'),e=e.replace(/\[center\](.*?)\[\/center\]/gi,'<div class="text-center">$1</div>'),e=e.replace(/\[spoiler\](.*?)\[\/spoiler\]/gi,'<details class="bg-gray-100 dark:bg-gray-800 p-3 rounded-md my-4"><summary class="cursor-pointer font-medium text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white">Cliquez pour révéler le spoiler</summary><div class="mt-2 pt-2 border-t border-gray-200 dark:border-gray-600">$1</div></details>'),e),v=e=>{e=e.replace(/\[url=([^\]]+)\]([^\[]*)\[\/url\]/gi,'<a href="$1" target="_blank" rel="noopener noreferrer" class="text-blue-600 dark:text-blue-400 hover:underline">$2</a>'),e=e.replace(/\[url\]([^\[]*)\[\/url\]/gi,'<a href="$1" target="_blank" rel="noopener noreferrer" class="text-blue-600 dark:text-blue-400 hover:underline">$1</a>');const r=new RegExp(`(?<!href=["'])(https?:\\/\\/[^\\s<>]+)(?![^<]*>)`,"gi");return e=e.replace(r,'<a href="$1" target="_blank" rel="noopener noreferrer" class="text-blue-600 dark:text-blue-400 hover:underline">$1</a>'),e},y=e=>(e=e.replace(/\[img\]([^\[]*)\[\/img\]/gi,(r,s)=>{const l=s.trim(),i=a.enableImageModal?`onclick="window.handleReviewImageClick && window.handleReviewImageClick('${l}', 'Image de la critique')"`:"";return`<img src="${l}" alt="Image de la critique" class="max-w-full h-auto rounded-lg shadow-md my-6 cursor-pointer hover:shadow-lg transition-shadow" ${i} loading="lazy" />`}),e=e.replace(/\[img=([^\]]+)\]([^\[]*)\[\/img\]/gi,(r,s,l)=>{const i=l.trim(),d=s.trim(),_=a.enableImageModal?`onclick="window.handleReviewImageClick && window.handleReviewImageClick('${i}', '${d}')"`:"";return`<img src="${i}" alt="${d}" class="max-w-full h-auto rounded-lg shadow-md my-6 cursor-pointer hover:shadow-lg transition-shadow" ${_} loading="lazy" />`}),e),$=e=>(e=e.replace(/\r\n/g,`
`),e=e.replace(/\n{3,}/g,`

`),e=e.replace(/\n/g,"<br>"),e=e.replace(/\[br\]/gi,"<br>"),e=e.replace(/(<br>\s*){2,}/gi,"</p><p>"),e=`<p>${e}</p>`,e=e.replace(/<p>\s*<\/p>/gi,""),e=e.replace(/^<p>\s*<br>\s*/,"<p>"),e=e.replace(/\s*<br>\s*<\/p>$/,"</p>"),e),x=e=>(e=e.replace(/<script[^>]*>.*?<\/script>/gi,""),e=e.replace(/javascript:/gi,""),e=e.replace(/on\w+\s*=\s*["'][^"']*["']/gi,""),e=e.replace(/onclick="window\.handleReviewImageClick[^"]*"/gi,r=>r),e),o=()=>{if(!c.value||!a.showReadingProgress)return;const e=c.value,r=window.innerHeight;document.documentElement.scrollHeight-r;const s=window.scrollY,l=e.offsetTop,i=e.offsetHeight;if(s>=l){const d=Math.min((s-l+r)/i*100,100);t.value=Math.max(0,d)}else t.value=0};return window.handleReviewImageClick=(e,r)=>{h("image-click",e,r)},I(()=>{a.showReadingProgress&&(window.addEventListener("scroll",o,{passive:!0}),window.addEventListener("resize",o,{passive:!0}),o())}),q(()=>{a.showReadingProgress&&(window.removeEventListener("scroll",o),window.removeEventListener("resize",o))}),(e,r)=>(m(),p("div",L,[u("div",{ref_key:"contentRef",ref:c,class:"text-gray-900 dark:text-white leading-relaxed",innerHTML:n(f)},null,8,M),e.showReadingProgress?(m(),p("div",P,[u("div",{class:"h-full bg-blue-600 transition-all duration-150 ease-out",style:H({width:`${n(t)}%`})},null,4)])):z("",!0)]))}}),S=B(E,[["__scopeId","data-v-19b656e1"]]);export{S as default};
