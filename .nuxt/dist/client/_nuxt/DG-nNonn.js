import{f as K,g as u,H as N,h as Y,Y as D,G as O,m as P,ab as V,c,n as f,ac as X,a,t as b,b as k,k as o,N as G,B as H,y as Z,o as i,r as q,_ as W}from"./Bes98wj2.js";const J={class:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700"},Q={class:"text-lg font-semibold text-gray-900 dark:text-white truncate"},ee={class:"flex items-center space-x-2"},te={class:"relative overflow-auto max-h-[80vh]"},ae={key:0,class:"flex items-center justify-center p-12"},oe={key:1,class:"flex items-center justify-center p-12 text-center"},re={key:2,class:"relative"},se=["src","alt"],ne={key:0,class:"absolute top-4 right-4 bg-black bg-opacity-50 text-white px-2 py-1 rounded text-sm"},le={key:0,class:"p-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800"},ie={class:"flex items-center justify-between text-sm text-gray-600 dark:text-gray-400"},ce={class:"flex items-center space-x-4"},de={key:0},ue={key:1},me={key:2},ge=K({__name:"ReviewImageModal",props:{imageSrc:{},imageAlt:{default:""},show:{type:Boolean,default:!0}},emits:["close"],setup(C,{emit:z}){const h=C,M=z,m=u(!0),g=u(!1),r=u(!1),v=u(1),y=u(0),p=u(0),d=u({dimensions:null,size:null,type:null}),n=u(),B=N(()=>r.value?{transform:`scale(${v.value}) translate(${y.value}px, ${p.value}px)`,transformOrigin:"center center"}:{}),x=()=>{r.value=!1,v.value=1,y.value=0,p.value=0,m.value=!0,g.value=!1,M("close")},I=e=>{e.target===e.currentTarget&&x()},S=()=>{m.value=!1,g.value=!1,n.value&&(d.value.dimensions={width:n.value.naturalWidth,height:n.value.naturalHeight})},L=()=>{m.value=!1,g.value=!0},E=()=>{if(m.value=!0,g.value=!1,n.value){const e=h.imageSrc;n.value.src="",setTimeout(()=>{n.value&&(n.value.src=e)},100)}},w=()=>{r.value?(r.value=!1,v.value=1,y.value=0,p.value=0):(r.value=!0,v.value=2)},R=e=>{if(!r.value||!n.value)return;const t=n.value.getBoundingClientRect(),s=(e.clientX-t.left)/t.width,l=(e.clientY-t.top)/t.height,A=t.width*(v.value-1)/2,F=t.height*(v.value-1)/2;y.value=(.5-s)*A,p.value=(.5-l)*F},j=()=>{r.value&&(y.value=0,p.value=0)},U=async()=>{try{const t=await(await fetch(h.imageSrc)).blob(),s=window.URL.createObjectURL(t),l=document.createElement("a");l.href=s,l.download=`image-${Date.now()}.${t.type.split("/")[1]||"jpg"}`,document.body.appendChild(l),l.click(),document.body.removeChild(l),window.URL.revokeObjectURL(s)}catch(e){console.error("Error downloading image:",e)}},T=async()=>{if(navigator.share)try{await navigator.share({title:h.imageAlt||"Image partagée",url:h.imageSrc})}catch{console.log("Sharing cancelled or failed")}else try{await navigator.clipboard.writeText(h.imageSrc)}catch(e){console.error("Error copying to clipboard:",e)}},$=e=>{if(e===0)return"0 B";const t=1024,s=["B","KB","MB","GB"],l=Math.floor(Math.log(e)/Math.log(t));return parseFloat((e/Math.pow(t,l)).toFixed(1))+" "+s[l]},_=e=>{e.key==="Escape"?x():(e.key===" "||e.key==="Enter")&&(e.preventDefault(),w())};return Y(()=>{document.addEventListener("keydown",_),document.body.style.overflow="hidden"}),D(()=>{document.removeEventListener("keydown",_),document.body.style.overflow=""}),O(()=>h.imageSrc,()=>{m.value=!0,g.value=!1,r.value=!1,v.value=1,y.value=0,p.value=0}),(e,t)=>{const s=q("Icon");return i(),P(V,{to:"body"},[e.show?(i(),c("div",{key:0,class:"review-image-modal fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-75",onClick:I,onKeydown:X(x,["esc"])},[a("div",{class:"relative max-w-7xl max-h-full bg-white dark:bg-gray-900 rounded-lg shadow-xl overflow-hidden",onClick:t[0]||(t[0]=Z(()=>{},["stop"]))},[a("div",J,[a("h3",Q,b(e.imageAlt||"Image"),1),a("div",ee,[a("button",{onClick:U,class:"p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",title:"Télécharger l'image"},[k(s,{name:"heroicons:arrow-down-tray",class:"w-5 h-5"})]),a("button",{onClick:T,class:"p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",title:"Partager l'image"},[k(s,{name:"heroicons:share",class:"w-5 h-5"})]),a("button",{onClick:x,class:"p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",title:"Fermer"},[k(s,{name:"heroicons:x-mark",class:"w-5 h-5"})])])]),a("div",te,[o(m)?(i(),c("div",ae,t[1]||(t[1]=[a("div",{class:"animate-spin rounded-full h-8 w-8 border-2 border-blue-500 border-t-transparent"},null,-1),a("span",{class:"ml-3 text-gray-600 dark:text-gray-300"},"Chargement...",-1)]))):o(g)?(i(),c("div",oe,[a("div",null,[k(s,{name:"heroicons:exclamation-triangle",class:"w-12 h-12 text-red-400 mx-auto mb-3"}),t[2]||(t[2]=a("p",{class:"text-gray-600 dark:text-gray-300"},"Impossible de charger l'image",-1)),a("button",{onClick:E,class:"mt-3 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors"}," Réessayer ")])])):(i(),c("div",re,[a("img",{ref_key:"imageRef",ref:n,src:e.imageSrc,alt:e.imageAlt,class:H(["max-w-full h-auto mx-auto block",{"cursor-zoom-in":!o(r),"cursor-zoom-out":o(r),"transform transition-transform duration-200":!0}]),style:G(o(B)),onLoad:S,onError:L,onClick:w,onMousemove:R,onMouseleave:j},null,46,se),o(r)?f("",!0):(i(),c("div",ne," Cliquez pour zoomer "))]))]),!o(m)&&!o(g)?(i(),c("div",le,[a("div",ie,[a("div",ce,[o(d).dimensions?(i(),c("span",de,b(o(d).dimensions.width)+"×"+b(o(d).dimensions.height),1)):f("",!0),o(d).size?(i(),c("span",ue,b($(o(d).size)),1)):f("",!0),o(d).type?(i(),c("span",me,b(o(d).type.toUpperCase()),1)):f("",!0)]),t[3]||(t[3]=a("div",{class:"text-xs"}," Utilisez la molette pour zoomer, glissez pour déplacer ",-1))])])):f("",!0)])],32)):f("",!0)])}}}),he=W(ge,[["__scopeId","data-v-fcabbc48"]]);export{he as default};
