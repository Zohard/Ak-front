import{f as g,s as v,q as x,x as y,c as m,a as e,z as n,A as a,k as o,K as w,n as k,t as V,b as S,w as C,y as U,j as A,e as B,o as p,d as N,_ as T}from"./CCeOfYC8.js";const E={class:"main-content max-w-3xl"},$={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},q={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},D={class:"grid grid-cols-1 md:grid-cols-2 gap-4 items-end"},F={key:0,class:"text-xs text-gray-500 mt-1"},M={class:"flex gap-3"},R=g({__name:"create",setup(j){const u=A(),b=v(),d=x(),s=y({titre:"",statut:0}),f=async i=>{const t=i.target.files;if(!t||!t[0])return;const r=new FormData;r.append("file",t[0]),r.append("type","anime");try{const l=await $fetch(`${u.public.apiBase}/api/media/upload`,{method:"POST",body:r,headers:d.getAuthHeaders()});s.image=l.filename}catch(l){console.error("Upload error",l),alert("Échec de l'upload")}},c=async()=>{try{await $fetch(`${u.public.apiBase}/api/admin/animes`,{method:"POST",headers:{"Content-Type":"application/json",...d.getAuthHeaders()},body:s}),b.push("/admin/animes")}catch(i){console.error(i),alert(i?.data?.message||"Erreur lors de la création")}};return(i,t)=>{const r=B;return p(),m("div",E,[t[18]||(t[18]=e("h1",{class:"section-title mb-4"},"Créer un anime",-1)),e("form",{class:"card p-5 space-y-4",onSubmit:U(c,["prevent"])},[e("div",null,[t[7]||(t[7]=e("label",{class:"block text-sm mb-1"},"Titre *",-1)),n(e("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>o(s).titre=l),class:"form-input w-full",required:""},null,512),[[a,o(s).titre]])]),e("div",$,[e("div",null,[t[8]||(t[8]=e("label",{class:"block text-sm mb-1"},"Année",-1)),n(e("input",{"onUpdate:modelValue":t[1]||(t[1]=l=>o(s).annee=l),type:"number",min:"1900",class:"form-input w-full"},null,512),[[a,o(s).annee,void 0,{number:!0}]])]),e("div",null,[t[9]||(t[9]=e("label",{class:"block text-sm mb-1"},"Nombre d'épisodes",-1)),n(e("input",{"onUpdate:modelValue":t[2]||(t[2]=l=>o(s).nbEp=l),type:"number",min:"0",class:"form-input w-full"},null,512),[[a,o(s).nbEp,void 0,{number:!0}]])])]),e("div",q,[e("div",null,[t[10]||(t[10]=e("label",{class:"block text-sm mb-1"},"Studio",-1)),n(e("input",{"onUpdate:modelValue":t[3]||(t[3]=l=>o(s).studio=l),class:"form-input w-full"},null,512),[[a,o(s).studio]])]),e("div",null,[t[11]||(t[11]=e("label",{class:"block text-sm mb-1"},"Réalisateur",-1)),n(e("input",{"onUpdate:modelValue":t[4]||(t[4]=l=>o(s).realisateur=l),class:"form-input w-full"},null,512),[[a,o(s).realisateur]])])]),e("div",null,[t[12]||(t[12]=e("label",{class:"block text-sm mb-1"},"Synopsis",-1)),n(e("textarea",{"onUpdate:modelValue":t[5]||(t[5]=l=>o(s).synopsis=l),rows:"4",class:"form-input w-full"},null,512),[[a,o(s).synopsis]])]),e("div",D,[e("div",null,[t[14]||(t[14]=e("label",{class:"block text-sm mb-1"},"Statut",-1)),n(e("select",{"onUpdate:modelValue":t[6]||(t[6]=l=>o(s).statut=l),class:"form-input w-full"},t[13]||(t[13]=[e("option",{value:1},"Affichée",-1),e("option",{value:2},"En attente",-1),e("option",{value:0},"Bloquée",-1)]),512),[[w,o(s).statut,void 0,{number:!0}]])]),e("div",null,[t[15]||(t[15]=e("label",{class:"block text-sm mb-1"},"Image (upload)",-1)),e("input",{type:"file",accept:"image/*",onChange:f},null,32),o(s).image?(p(),m("div",F,"Fichier: "+V(o(s).image),1)):k("",!0)])]),e("div",M,[t[17]||(t[17]=e("button",{type:"submit",class:"btn-primary"},"Créer",-1)),S(r,{to:"/admin/animes",class:"btn-secondary"},{default:C(()=>t[16]||(t[16]=[N("Annuler",-1)])),_:1,__:[16]})])],32)])}}}),I=T(R,[["__scopeId","data-v-2502f4f3"]]);export{I as default};
