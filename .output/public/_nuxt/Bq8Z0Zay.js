import{f as R,g,H as N,h as P,Y as z,c as o,k as i,a as s,t as p,N as I,F as E,l as H,b as y,j as V,o as c,B as q,n as M,d as O,Z as b,p as F,_ as j}from"./Bes98wj2.js";import{u as L}from"./DzvRhcSF.js";import{u as X}from"./DMFesj3P.js";import{s as Y}from"./x_rD_Ya3.js";const Z={class:"modern-hero-carousel"},G={key:0,class:"loading"},J={key:1,class:"error"},K={key:2,class:"error"},Q={key:3,class:"carousel-container"},W={class:"carousel-wrapper"},ee={class:"slide-image-container"},te=["src","alt"],se={class:"slide-content"},ae={class:"slide-title"},ie={class:"slide-subtitle"},le=["onClick"],re=["disabled"],ne=["disabled"],oe={class:"progress-container"},ce=R({__name:"ModernHeroBanner",setup(ue){const w=g(!0),m=g(""),t=g([]),n=g(0),u=g(!1),{getImageUrl:S,getArticleImageUrl:U}=L(),$=X(),D=V();N(()=>t.value[n.value]||{});const T=async()=>{try{const[l,r]=await Promise.allSettled([$.fetchReviews({limit:6,sortBy:"dateCritique",sortOrder:"desc"}),$fetch(`${D.public.apiBase}/api/articles`,{params:{limit:6,sort:"date",order:"DESC",status:"published"}})]),a=[];if(l.status==="fulfilled"){const v=l.value.data||l.value.reviews||[];for(const e of v){const d=e.anime||e.manga,f=d?.image||"",x=e.anime?"anime":"manga";a.push({key:`review-${e.idCritique}`,type:"review",title:e.titre||d?.titre||"Critique",subtitle:e.critique?e.critique.length>120?e.critique.slice(0,120)+"...":e.critique:"Découvrez la dernière critique de la communauté",imageUrl:f?S(f,x):null,link:e.niceUrl?`/review/${e.niceUrl}`:`/review/${e.idCritique}`,date:e.dateCritique||new Date().toISOString(),alt:d?.titre||e.titre||"Critique"})}}const h=[];if(r.status==="fulfilled"){const v=r.value.articles||[];for(const e of v){const d=e.imgunebig||e.imgunebig2||e.img||"",f=d?U(d):null;h.push({key:`article-${e.idArt}`,type:"article",title:e.titre,subtitle:e.metaDescription||e.postExcerpt||"Découvrez notre dernier article",imageUrl:f,link:e.niceUrl?`/articles/${e.niceUrl}`:`/articles/${e.idArt}`,date:e.date||e.postDate||new Date().toISOString(),alt:e.titre})}}const C=[...a,...h].sort((v,e)=>new Date(e.date).getTime()-new Date(v.date).getTime()).slice(0,8);t.value=C,t.value.length===0&&(m.value="Aucun contenu trouvé")}catch(l){console.error("Hero content fetch error:",l),m.value=l.message||"Erreur lors du chargement"}finally{w.value=!1}},k=()=>{u.value||t.value.length<=1||(u.value=!0,n.value=(n.value+1)%t.value.length,setTimeout(()=>{u.value=!1},500))},A=()=>{u.value||t.value.length<=1||(u.value=!0,n.value=(n.value-1+t.value.length)%t.value.length,setTimeout(()=>{u.value=!1},500))},B=l=>{F(l.link)};let _=null;return P(async()=>{await T(),t.value.length>1&&(_=Y(()=>k(),8e3))}),z(()=>{_&&clearInterval(_)}),(l,r)=>(c(),o("div",Z,[i(w)?(c(),o("div",G,r[0]||(r[0]=[s("div",{class:"loading-skeleton"},null,-1)]))):i(m)?(c(),o("div",J,p(i(m)),1)):i(t).length===0?(c(),o("div",K,"Aucun contenu trouvé")):(c(),o("div",Q,[s("div",W,[s("div",{class:"carousel-track",style:I({transform:`translateX(-${i(n)*100}%)`})},[(c(!0),o(E,null,H(i(t),(a,h)=>(c(),o("div",{key:a.key,class:q(["carousel-slide",{active:h===i(n)}])},[s("div",ee,[a.imageUrl?(c(),o("img",{key:0,src:a.imageUrl,alt:a.alt||a.title,class:"slide-image",loading:"eager"},null,8,te)):M("",!0),r[1]||(r[1]=s("div",{class:"image-overlay"},null,-1))]),s("div",se,[s("div",{class:q(["content-badge",a.type])},p(a.type==="review"?"Critique":"Article"),3),s("h2",ae,p(a.title),1),s("p",ie,p(a.subtitle),1),s("button",{class:"slide-button",onClick:C=>B(a)},[y(b,{name:"heroicons:play",class:"w-5 h-5"}),r[2]||(r[2]=O(" Découvrir ",-1))],8,le)])],2))),128))],4)]),s("button",{class:"nav-button nav-prev",onClick:A,"aria-label":"Précédent",disabled:i(t).length<=1},[y(b,{name:"heroicons:chevron-left",class:"w-6 h-6"})],8,re),s("button",{class:"nav-button nav-next",onClick:k,"aria-label":"Suivant",disabled:i(t).length<=1},[y(b,{name:"heroicons:chevron-right",class:"w-6 h-6"})],8,ne),s("div",oe,[s("div",{class:"progress-bar",style:I({width:`${(i(n)+1)/i(t).length*100}%`})},null,4)])]))]))}}),he=j(ce,[["__scopeId","data-v-d6c6614b"]]);export{he as default};
