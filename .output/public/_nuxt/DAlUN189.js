import{f as D,u as S,v as q,g as h,I as H,G,h as K,c as i,a as e,n as g,b as c,w as B,k as t,t as n,d as m,F as M,l as j,B as v,m as Q,j as C,r as Y,e as J,H as F,o as l,_ as O}from"./CCeOfYC8.js";import{u as T}from"./CC4fhe8Z.js";import"./BJ2ClxiI.js";const W={class:"main-content"},X={class:"mb-6"},Z={key:0,class:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6 mb-8"},ee={class:"flex items-start gap-4"},te={class:"w-16 h-16 rounded-full bg-gradient-to-br from-purple-500 to-blue-500 flex items-center justify-center flex-shrink-0"},se={class:"text-white font-semibold text-2xl"},ae={class:"flex-1"},oe={class:"text-2xl font-bold text-gray-900 dark:text-white mb-2"},re={class:"flex items-center gap-4 text-sm text-gray-500 dark:text-gray-400 mb-4"},ne={class:"flex items-center gap-1"},le={class:"flex items-center gap-1"},ie={class:"flex items-center gap-6 text-sm"},de={class:"flex items-center gap-2"},ce={class:"font-medium"},ue={class:"flex items-center gap-2"},me={class:"font-medium"},ge={class:"flex items-center gap-2"},pe={class:"font-medium"},xe={class:"flex items-center gap-2"},be={class:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 mb-8"},ye={class:"border-b border-gray-200 dark:border-gray-700"},_e={class:"flex -mb-px","aria-label":"Collection Types"},he=["onClick"],fe={key:0,class:"ml-1 text-xs opacity-70"},ve={class:"p-6"},ke={class:"flex items-center gap-4 mb-6"},we={class:"flex bg-gray-100 dark:bg-gray-700 rounded-lg p-1"},Ce={key:0,class:"flex items-center justify-center py-12"},$e={key:1,class:"text-center py-12"},ze={class:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-700 rounded-lg p-6 max-w-md mx-auto"},Ae={class:"text-red-600 dark:text-red-300 text-sm mb-4"},Ie={key:2,class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4"},Be={class:"relative aspect-[3/4] bg-gray-200 dark:bg-gray-600"},Me=["src","alt"],je={key:1,class:"absolute top-2 right-2"},Fe={class:"bg-yellow-500 text-white text-xs font-bold px-2 py-1 rounded-full flex items-center gap-1"},Re={class:"p-3"},Ue={class:"font-medium text-sm text-gray-900 dark:text-white line-clamp-2 mb-1"},Ve={class:"flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400"},Ee={key:0},Le={key:1},Ne={key:0,class:"mt-2 text-xs text-gray-600 dark:text-gray-400 line-clamp-2"},Pe={class:"mt-2 text-xs text-gray-500 dark:text-gray-500"},De={key:3,class:"text-center py-12"},Se={class:"text-lg font-medium text-gray-900 dark:text-white mb-2"},qe={class:"text-gray-500 dark:text-gray-400"},He={key:4,class:"text-center mt-8"},Ge=["disabled"],Ke={key:0,class:"animate-spin rounded-full h-4 w-4 border-2 border-purple-500 border-t-transparent"},Qe=D({__name:"[id]",async setup(Ye){let f,$;S({title:"Collections Utilisateur - Anime-Kun"});const R=q(),k=parseInt(R.params.id),p=h(1),o=h("animes"),x=h(!1),y=h(1),U=[{type:1,name:"Terminé",color:"bg-green-500"},{type:2,name:"Planifié",color:"bg-yellow-500"},{type:3,name:"En cours",color:"bg-blue-500"},{type:4,name:"Abandonné",color:"bg-red-500"}],u=h(null),V=async()=>{try{const d=C(),r=(await $fetch(`${d.public.apiBase}/api/collections/browse`,{params:{limit:1e3}})).data?.find(_=>_.id===k);r&&(u.value=r)}catch(d){console.error("Failed to fetch user info:",d)}},{data:b,pending:E,error:z,refresh:w}=([f,$]=H(()=>T(()=>`${C().public.apiBase}/api/collections/user/${k}/type/${p.value}/${o.value}`,{params:F(()=>({page:y.value,limit:20})),key:F(()=>`user-collection-${k}-${p.value}-${o.value}-${y.value}`),watch:[p,o],onResponse({response:d}){d.status===200&&y.value>1&&b.value?.data&&b.value.data.push(...d._data.data)}},"$hYcFzmaQnl")),f=await f,$(),f);G([p,o],()=>{y.value=1}),K(()=>{V()});const A=d=>new Date(d).toLocaleDateString("fr-FR",{day:"numeric",month:"short",year:"numeric"}),L=d=>{const s=C(),r=o.value==="animes"?"animes":"mangas";return`${s.public.apiBase}/uploads/${r}/${d}`},N=d=>({1:"terminés",2:"planifiés",3:"en cours",4:"abandonnés"})[d]||"",I=d=>{if(!u.value)return 0;const s=u.value.collections?.find(r=>r.type===d);return s?o.value==="animes"?s.animeCount:s.mangaCount:0},P=async()=>{if(!(x.value||!b.value?.meta?.hasMore)){x.value=!0,y.value+=1;try{await w()}finally{x.value=!1}}};return(d,s)=>{const r=Y("Icon"),_=J;return l(),i("div",W,[e("div",X,[c(_,{to:"/collections",class:"inline-flex items-center text-purple-600 dark:text-purple-400 hover:text-purple-700 dark:hover:text-purple-300 font-medium"},{default:B(()=>[c(r,{name:"heroicons:arrow-left",size:"xs",class:"mr-2"}),s[3]||(s[3]=m(" Retour aux collections ",-1))]),_:1,__:[3]})]),t(u)?(l(),i("div",Z,[e("div",ee,[e("div",te,[e("span",se,n(t(u).username.charAt(0).toUpperCase()),1)]),e("div",ae,[e("h1",oe," Collections de "+n(t(u).username),1),e("div",re,[e("span",ne,[c(r,{name:"heroicons:calendar",size:"xs"}),m(" Membre depuis "+n(A(t(u).joinedAt)),1)]),e("span",le,[c(r,{name:"heroicons:globe-alt",size:"xs"}),s[4]||(s[4]=m(" Collections publiques uniquement ",-1))])]),e("div",ie,[e("div",de,[c(r,{name:"heroicons:film",size:"xs",class:"text-purple-600"}),e("span",ce,n(t(u).totalPublicAnimes),1),s[5]||(s[5]=e("span",{class:"text-gray-500 dark:text-gray-400"},"animes",-1))]),e("div",ue,[c(r,{name:"heroicons:book-open",size:"xs",class:"text-blue-600"}),e("span",me,n(t(u).totalPublicMangas),1),s[6]||(s[6]=e("span",{class:"text-gray-500 dark:text-gray-400"},"mangas",-1))]),e("div",ge,[c(r,{name:"heroicons:rectangle-stack",size:"xs",class:"text-green-600"}),e("span",pe,n(t(u).totalPublicItems),1),s[7]||(s[7]=e("span",{class:"text-gray-500 dark:text-gray-400"},"total",-1))])])]),e("div",xe,[c(_,{to:`/user/${t(u).username}`,class:"btn-secondary flex items-center gap-2"},{default:B(()=>[c(r,{name:"heroicons:user",size:"xs"}),s[8]||(s[8]=m(" Voir le profil ",-1))]),_:1,__:[8]},8,["to"])])])])):g("",!0),e("div",be,[e("div",ye,[e("nav",_e,[(l(),i(M,null,j(U,a=>e("button",{key:a.type,class:v(["py-4 px-6 border-b-2 font-medium text-sm transition-colors duration-200 flex items-center gap-2",t(p)===a.type?"border-purple-500 text-purple-600 dark:text-purple-400 bg-purple-50 dark:bg-purple-900/20":"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600"]),onClick:Je=>p.value=a.type},[e("div",{class:v([`w-3 h-3 rounded-full ${a.color}`])},null,2),m(" "+n(a.name)+" ",1),t(u)&&I(a.type)>0?(l(),i("span",fe," ("+n(I(a.type))+") ",1)):g("",!0)],10,he)),64))])]),e("div",ve,[e("div",ke,[e("div",we,[e("button",{class:v(["px-3 py-1 rounded text-sm font-medium transition-colors",t(o)==="animes"?"bg-white dark:bg-gray-600 text-gray-900 dark:text-white shadow-sm":"text-gray-600 dark:text-gray-400"]),onClick:s[0]||(s[0]=a=>o.value="animes")},[c(r,{name:"heroicons:film",size:"xs",class:"mr-1"}),s[9]||(s[9]=m(" Animes ",-1))],2),e("button",{class:v(["px-3 py-1 rounded text-sm font-medium transition-colors",t(o)==="mangas"?"bg-white dark:bg-gray-600 text-gray-900 dark:text-white shadow-sm":"text-gray-600 dark:text-gray-400"]),onClick:s[1]||(s[1]=a=>o.value="mangas")},[c(r,{name:"heroicons:book-open",size:"xs",class:"mr-1"}),s[10]||(s[10]=m(" Mangas ",-1))],2)])]),t(E)?(l(),i("div",Ce,s[11]||(s[11]=[e("div",{class:"animate-spin rounded-full h-8 w-8 border-2 border-purple-500 border-t-transparent"},null,-1),e("span",{class:"ml-3 text-gray-600 dark:text-gray-300"},"Chargement...",-1)]))):t(z)?(l(),i("div",$e,[e("div",ze,[c(r,{name:"heroicons:exclamation-triangle",class:"w-8 h-8 text-red-500 mx-auto mb-3"}),s[12]||(s[12]=e("h3",{class:"text-lg font-medium text-red-800 dark:text-red-200 mb-2"},"Erreur de chargement",-1)),e("p",Ae,n(t(z)),1),e("button",{class:"btn-secondary",onClick:s[2]||(s[2]=(...a)=>t(w)&&t(w)(...a))},"Réessayer")])])):t(b)?.data?.length?(l(),i("div",Ie,[(l(!0),i(M,null,j(t(b).data,a=>(l(),i("div",{key:a.id,class:"bg-gray-50 dark:bg-gray-700 rounded-lg overflow-hidden hover:shadow-md transition-all duration-300 group"},[e("div",Be,[a[t(o).slice(0,-1)]?.image?(l(),i("img",{key:0,src:L(a[t(o).slice(0,-1)].image),alt:a[t(o).slice(0,-1)]?.titre,class:"w-full h-full object-cover"},null,8,Me)):g("",!0),s[13]||(s[13]=e("div",{class:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-20 transition-opacity duration-300"},null,-1)),a.rating?(l(),i("div",je,[e("div",Fe,[c(r,{name:"heroicons:star-solid",size:"xs"}),m(" "+n(a.rating),1)])])):g("",!0)]),e("div",Re,[e("h3",Ue,n(a[t(o).slice(0,-1)]?.titre),1),e("div",Ve,[a[t(o).slice(0,-1)]?.annee?(l(),i("span",Ee,n(a[t(o).slice(0,-1)].annee),1)):g("",!0),a[t(o).slice(0,-1)]?.nbEp?(l(),i("span",Le,n(a[t(o).slice(0,-1)].nbEp)+" ép.",1)):g("",!0)]),a.notes?(l(),i("div",Ne,' "'+n(a.notes)+'" ',1)):g("",!0),e("div",Pe," Ajouté "+n(A(a.addedAt)),1)]),c(_,{to:`/${t(o).slice(0,-1)}/${a[t(o).slice(0,-1)]?.niceUrl||a[t(o).slice(0,-1)]?.id}`,class:"absolute inset-0 z-10","aria-label":`Voir ${a[t(o).slice(0,-1)]?.titre}`},null,8,["to","aria-label"])]))),128))])):(l(),i("div",De,[c(r,{name:t(o)==="animes"?"heroicons:film":"heroicons:book-open",class:"w-16 h-16 text-gray-400 mx-auto mb-4"},null,8,["name"]),e("h3",Se," Aucun "+n(t(o)==="animes"?"anime":"manga")+" "+n(N(t(p))),1),e("p",qe," L'utilisateur n'a pas encore ajouté de "+n(t(o)==="animes"?"animes":"mangas")+" dans cette collection. ",1)])),t(b)?.meta?.hasMore?(l(),i("div",He,[e("button",{onClick:P,disabled:t(x),class:"btn-secondary inline-flex items-center gap-2"},[t(x)?(l(),i("div",Ke)):(l(),Q(r,{key:1,name:"heroicons:arrow-down",size:"xs"})),m(" "+n(t(x)?"Chargement...":"Charger plus"),1)],8,Ge)])):g("",!0)])])])}}}),Xe=O(Qe,[["__scopeId","data-v-e7f7e46e"]]);export{Xe as default};
