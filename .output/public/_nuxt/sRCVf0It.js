import{f as F,u as H,q as L,I as T,g as h,h as E,c as n,k as t,a as e,z as b,n as p,M as f,t as l,b as g,d as C,F as m,l as y,j as K,p as G,r as W,o,B as J,m as O,w as P,N as B,e as Q,_ as X}from"./CCeOfYC8.js";const Y={class:"min-h-screen bg-gray-50 dark:bg-gray-900"},Z={key:0,class:"flex items-center justify-center py-12"},ee={key:1,class:"container mx-auto px-4 py-8"},te={class:"bg-white dark:bg-gray-800 rounded-lg shadow-lg overflow-hidden mb-8"},se={class:"px-6 py-6 relative"},ae={class:"absolute -top-16 left-6"},re={class:"w-24 h-24 rounded-full border-4 border-white dark:border-gray-800 overflow-hidden bg-blue-500 flex items-center justify-center"},oe=["src","alt"],ne={key:1,class:"text-white text-2xl font-bold"},ie={class:"ml-32"},le={class:"text-2xl font-bold text-gray-900 dark:text-white mb-2"},de={key:0,class:"text-gray-600 dark:text-gray-400 mb-2"},ce={class:"flex flex-wrap gap-4 text-sm text-gray-600 dark:text-gray-400"},ue={key:0,class:"flex items-center"},ge={key:1,class:"flex items-center"},he={class:"flex items-center"},pe={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},xe={class:"bg-white dark:bg-gray-800 rounded-lg shadow p-6"},me={class:"flex items-center justify-between"},ye={class:"text-2xl font-bold text-gray-900 dark:text-white"},_e={class:"bg-white dark:bg-gray-800 rounded-lg shadow p-6"},be={class:"flex items-center justify-between"},fe={class:"text-2xl font-bold text-gray-900 dark:text-white"},ve={class:"bg-white dark:bg-gray-800 rounded-lg shadow p-6"},ke={class:"flex items-center justify-between"},we={class:"text-2xl font-bold text-gray-900 dark:text-white"},Ae={class:"bg-white dark:bg-gray-800 rounded-lg shadow p-6"},$e={class:"flex items-center justify-between"},Ce={class:"text-2xl font-bold text-gray-900 dark:text-white"},Se={class:"bg-white dark:bg-gray-800 rounded-lg shadow-lg overflow-hidden"},je={class:"border-b border-gray-200 dark:border-gray-700"},Ne={class:"flex space-x-8 px-6","aria-label":"Tabs"},Ue=["onClick"],Be={class:"p-6"},Ie={class:"space-y-6"},Me={key:0,class:"space-y-4"},Re={class:"flex-shrink-0"},De={class:"flex-1"},Ve={class:"text-sm text-gray-900 dark:text-white"},qe={class:"text-xs text-gray-500 dark:text-gray-400 mt-1"},ze={key:1,class:"text-center py-8 text-gray-500 dark:text-gray-400"},Fe={class:"space-y-6"},He={key:0,class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-6 gap-4"},Le=["src","alt"],Te={class:"mt-2 text-sm text-gray-700 dark:text-gray-300 text-center line-clamp-2"},Ee={class:"text-xs text-gray-500 dark:text-gray-400 text-center"},Ke={key:1,class:"text-center py-8 text-gray-500 dark:text-gray-400"},Ge={class:"space-y-6"},We={key:0,class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4"},Je={class:"space-y-2"},Oe={class:"text-sm text-gray-600 dark:text-gray-400"},Pe={class:"flex items-center space-x-2"},Qe={class:"w-20 bg-gray-200 dark:bg-gray-600 rounded-full h-2"},Xe={class:"text-sm text-gray-900 dark:text-white font-medium"},Ye={key:1,class:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4"},Ze={class:"space-y-2"},et={class:"text-sm text-gray-600 dark:text-gray-400"},tt={class:"flex items-center space-x-2"},st={class:"w-20 bg-gray-200 dark:bg-gray-600 rounded-full h-2"},at={class:"text-sm text-gray-900 dark:text-white font-medium"},rt=F({__name:"profile",async setup(ot){let S,j;H({title:"Mon Profil - Anime-Kun V2",meta:[{name:"description",content:"Votre profil utilisateur Anime-Kun"}]});const u=L(),_=K();u.isAuthenticated||([S,j]=T(()=>G("/login?redirect=/profile")),await S,j());const v=h(!0),x=h("activity"),i=h(null),d=h(null),k=h([]),w=h([]),A=h(!1),I=[{id:"activity",label:"Activité récente"},{id:"recommendations",label:"Recommandations"},{id:"stats",label:"Statistiques"}],$=s=>s?new Date(typeof s=="string"?parseInt(s)*1e3:s*1e3).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric"}):"Non spécifié",M=s=>{switch(s){case"review":return"heroicons:star";case"anime_added":return"heroicons:play";case"manga_added":return"heroicons:book-open";case"list_created":return"heroicons:list-bullet";default:return"heroicons:clock"}},R=s=>{switch(s.type){case"review":return`A écrit une critique pour "${s.title}"`;case"anime_added":return`A ajouté l'anime "${s.title}" à sa collection`;case"manga_added":return`A ajouté le manga "${s.title}" à sa collection`;case"list_created":return`A créé une nouvelle liste "${s.title}"`;default:return s.description||"Activité inconnue"}},D=s=>s.type==="anime"?`/anime/${s.niceUrl||N(s.titre)}-${s.id}`:`/manga/${s.niceUrl||N(s.titre)}-${s.id}`,N=s=>s.toLowerCase().replace(/[àáâãäå]/g,"a").replace(/[èéêë]/g,"e").replace(/[ìíîï]/g,"i").replace(/[òóôõö]/g,"o").replace(/[ùúûü]/g,"u").replace(/[ýÿ]/g,"y").replace(/[ñ]/g,"n").replace(/[ç]/g,"c").replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,""),V=(s,a)=>s?s.startsWith("http")?s:`${_.public.apiBase}/images/${a}s/${s}`:"/placeholder-image.jpg",q=async()=>{try{v.value=!0,i.value=u.user;const s=await $fetch(`${_.public.apiBase}/api/users/${u.user.id}/stats`,{headers:u.getAuthHeaders()});d.value=s;const a=await $fetch(`${_.public.apiBase}/api/users/${u.user.id}/activity`,{headers:u.getAuthHeaders()});k.value=a.activities||[];const c=await $fetch(`${_.public.apiBase}/api/users/${u.user.id}/recommendations`,{headers:u.getAuthHeaders()});w.value=c.items||[]}catch(s){console.error("Error loading profile:",s)}finally{v.value=!1}};return E(()=>{q()}),(s,a)=>{const c=W("Icon"),z=Q;return o(),n("div",Y,[t(v)?(o(),n("div",Z,a[1]||(a[1]=[e("div",{class:"animate-spin rounded-full h-8 w-8 border-2 border-blue-500 border-t-transparent"},null,-1),e("span",{class:"ml-3 text-gray-600 dark:text-gray-300"},"Chargement du profil...",-1)]))):(o(),n("div",ee,[e("div",te,[a[2]||(a[2]=e("div",{class:"h-32 bg-gradient-to-r from-blue-500 to-purple-600"},null,-1)),e("div",se,[e("div",ae,[e("div",re,[t(i)?.avatar?b((o(),n("img",{key:0,src:t(i).avatar,alt:t(i)?.realName||t(i)?.username,class:"w-full h-full object-cover",onError:a[0]||(a[0]=r=>A.value=!0)},null,40,oe)),[[f,!t(A)]]):p("",!0),!t(i)?.avatar||t(A)?(o(),n("span",ne,l(t(i)?.realName?.charAt(0)?.toUpperCase()||t(i)?.username?.charAt(0)?.toUpperCase()||"U"),1)):p("",!0)])]),e("div",ie,[e("h1",le,l(t(i)?.realName||t(i)?.username),1),t(i)?.username&&t(i)?.realName?(o(),n("p",de," @"+l(t(i).username),1)):p("",!0),e("div",ce,[t(i)?.location?(o(),n("div",ue,[g(c,{name:"heroicons:map-pin",class:"w-4 h-4 mr-1"}),C(" "+l(t(i).location),1)])):p("",!0),t(i)?.birthday?(o(),n("div",ge,[g(c,{name:"heroicons:cake",class:"w-4 h-4 mr-1"}),C(" "+l($(t(i).birthday)),1)])):p("",!0),e("div",he,[g(c,{name:"heroicons:calendar",class:"w-4 h-4 mr-1"}),C(" Membre depuis "+l($(t(i)?.registrationDate)),1)])])])])]),e("div",pe,[e("div",xe,[e("div",me,[e("div",null,[a[3]||(a[3]=e("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"Critiques",-1)),e("p",ye,l(t(d)?.totalReviews||0),1)]),g(c,{name:"heroicons:star",class:"w-8 h-8 text-yellow-500"})])]),e("div",_e,[e("div",be,[e("div",null,[a[4]||(a[4]=e("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"Animes en collection",-1)),e("p",fe,l(t(d)?.animeCount||0),1)]),g(c,{name:"heroicons:play",class:"w-8 h-8 text-blue-500"})])]),e("div",ve,[e("div",ke,[e("div",null,[a[5]||(a[5]=e("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"Mangas en collection",-1)),e("p",we,l(t(d)?.mangaCount||0),1)]),g(c,{name:"heroicons:book-open",class:"w-8 h-8 text-green-500"})])]),e("div",Ae,[e("div",$e,[e("div",null,[a[6]||(a[6]=e("p",{class:"text-sm text-gray-600 dark:text-gray-400"},"Messages forum",-1)),e("p",Ce,l(t(i)?.posts||0),1)]),g(c,{name:"heroicons:chat-bubble-left",class:"w-8 h-8 text-purple-500"})])])]),e("div",Se,[e("div",je,[e("nav",Ne,[(o(),n(m,null,y(I,r=>e("button",{key:r.id,onClick:U=>x.value=r.id,class:J([t(x)===r.id?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300","whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"])},l(r.label),11,Ue)),64))])]),e("div",Be,[b(e("div",Ie,[a[7]||(a[7]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"},"Activité récente",-1)),t(k).length?(o(),n("div",Me,[(o(!0),n(m,null,y(t(k),r=>(o(),n("div",{key:r.id,class:"flex items-start space-x-4 p-4 border border-gray-200 dark:border-gray-700 rounded-lg"},[e("div",Re,[g(c,{name:M(r.type),class:"w-6 h-6 text-gray-500"},null,8,["name"])]),e("div",De,[e("p",Ve,l(R(r)),1),e("p",qe,l($(r.date)),1)])]))),128))])):(o(),n("div",ze," Aucune activité récente "))],512),[[f,t(x)==="activity"]]),b(e("div",Fe,[a[8]||(a[8]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"},"Recommandations pour vous",-1)),t(w).length?(o(),n("div",He,[(o(!0),n(m,null,y(t(w),r=>(o(),O(z,{key:r.id,to:D(r),class:"group"},{default:P(()=>[e("img",{src:V(r.image,r.type),alt:r.titre,class:"w-full aspect-[3/4] object-cover rounded-lg transition-transform group-hover:scale-105"},null,8,Le),e("p",Te,l(r.titre),1),e("p",Ee,l(r.type==="anime"?"Anime":"Manga"),1)]),_:2},1032,["to"]))),128))])):(o(),n("div",Ke," Aucune recommandation disponible pour le moment "))],512),[[f,t(x)==="recommendations"]]),b(e("div",Ge,[a[11]||(a[11]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"},"Statistiques détaillées",-1)),t(d)?.genreStats?(o(),n("div",We,[a[9]||(a[9]=e("h4",{class:"font-medium text-gray-900 dark:text-white mb-3"},"Genres préférés",-1)),e("div",Je,[(o(!0),n(m,null,y(t(d).genreStats.slice(0,5),r=>(o(),n("div",{key:r.name,class:"flex items-center justify-between"},[e("span",Oe,l(r.name),1),e("div",Pe,[e("div",Qe,[e("div",{class:"bg-blue-500 h-2 rounded-full",style:B({width:`${r.count/t(d).genreStats[0].count*100}%`})},null,4)]),e("span",Xe,l(r.count),1)])]))),128))])])):p("",!0),t(d)?.ratingStats?(o(),n("div",Ye,[a[10]||(a[10]=e("h4",{class:"font-medium text-gray-900 dark:text-white mb-3"},"Distribution des notes",-1)),e("div",Ze,[(o(!0),n(m,null,y(t(d).ratingStats,r=>(o(),n("div",{key:r.rating,class:"flex items-center justify-between"},[e("span",et,l(r.rating)+" étoiles",1),e("div",tt,[e("div",st,[e("div",{class:"bg-yellow-500 h-2 rounded-full",style:B({width:`${r.count/Math.max(...t(d).ratingStats.map(U=>U.count))*100}%`})},null,4)]),e("span",at,l(r.count),1)])]))),128))])])):p("",!0)],512),[[f,t(x)==="stats"]])])])]))])}}}),it=X(rt,[["__scopeId","data-v-8ece8466"]]);export{it as default};
