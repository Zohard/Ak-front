import{u as R}from"./B9jFdIe5.js";import{u as T}from"./C_YtV1it.js";import{f as E,g as p,H as P,h as x,Y as H,c as l,k as t,t as _,a as s,n as z,B as C,F as O,l as F,j as L,p as N,o,_ as V}from"./CCeOfYC8.js";import{s as j}from"./x_rD_Ya3.js";const M={class:"hero-carousel"},Y={key:0,class:"loading"},G={key:1,class:"error"},J={key:2,class:"error"},K={key:3,class:"carousel-container"},Q={class:"carousel-slide"},W=["src","alt"],X={class:"hero-content"},Z={class:"hero-title"},ee={class:"hero-subtitle"},te={class:"hero-actions"},ae={class:"carousel-dots"},se=["onClick","aria-label"],ie=E({__name:"SimpleHeroBanner",setup(re){const y=p(!0),g=p(""),i=p([]),n=p(0),{getImageUrl:w,getArticleImageUrl:I}=R(),S=T(),q=L(),r=P(()=>i.value[n.value]||{}),U=async()=>{try{const[a,d]=await Promise.allSettled([S.fetchReviews({limit:4,sortBy:"dateCritique",sortOrder:"desc"}),$fetch(`${q.public.apiBase}/api/articles`,{params:{limit:4,sort:"date",order:"DESC",status:"published"}})]),m=[];if(a.status==="fulfilled"){const v=a.value.data||a.value.reviews||[];for(const e of v){const u=e.anime||e.manga,h=u?.image||"",B=e.anime?"anime":"manga";m.push({key:`review-${e.idCritique}`,type:"review",title:e.titre||u?.titre||"Critique",subtitle:e.critique?e.critique.length>140?e.critique.slice(0,140)+"...":e.critique:"Découvrez la dernière critique de la communauté",imageUrl:h?w(h,B):null,link:e.niceUrl?`/review/${e.niceUrl}`:`/review/${e.idCritique}`,date:e.dateCritique||new Date().toISOString(),alt:u?.titre||e.titre||"Critique"})}}const c=[];if(d.status==="fulfilled"){const v=d.value.articles||[];for(const e of v){const u=e.imgunebig||e.imgunebig2||e.img||"",h=u?I(u):null;c.push({key:`article-${e.idArt}`,type:"article",title:e.titre,subtitle:e.metaDescription||e.postExcerpt||"Découvrez notre dernier article",imageUrl:h,link:e.niceUrl?`/articles/${e.niceUrl}`:`/articles/${e.idArt}`,date:e.date||e.postDate||new Date().toISOString(),alt:e.titre})}}const b=[...m,...c].sort((v,e)=>new Date(e.date).getTime()-new Date(v.date).getTime());i.value=b.slice(0,8),i.value.length===0&&(g.value="Aucun contenu trouvé")}catch(a){console.error("Hero content fetch error:",a),g.value=a.message||"Erreur lors du chargement"}finally{y.value=!1}},k=()=>{n.value=(n.value+1)%i.value.length},$=()=>{n.value=(n.value-1+i.value.length)%i.value.length},D=a=>{n.value=a},A=a=>{N(a.link)};let f=null;return x(async()=>{await U(),i.value.length>1&&(f=j(()=>k(),6e3))}),H(()=>{f&&clearInterval(f)}),(a,d)=>(o(),l("div",M,[t(y)?(o(),l("div",Y,"Chargement du contenu...")):t(g)?(o(),l("div",G,"Erreur: "+_(t(g)),1)):t(i).length===0?(o(),l("div",J,"Aucun contenu trouvé")):(o(),l("div",K,[s("div",Q,[t(r).imageUrl?(o(),l("img",{key:0,src:t(r).imageUrl,alt:t(r).alt||t(r).title,class:"hero-image",loading:"eager"},null,8,W)):z("",!0),s("div",X,[s("div",{class:C(["hero-badge",t(r).type])},_(t(r).type==="review"?"Critique":"Article"),3),s("h1",Z,_(t(r).title),1),s("p",ee,_(t(r).subtitle),1),s("div",te,[s("button",{class:"hero-button primary",onClick:d[0]||(d[0]=m=>A(t(r)))}," Lire ")])])]),s("button",{class:"carousel-nav prev",onClick:$,"aria-label":"Précédent"},"‹"),s("button",{class:"carousel-nav next",onClick:k,"aria-label":"Suivant"},"›"),s("div",ae,[(o(!0),l(O,null,F(t(i),(m,c)=>(o(),l("button",{key:m.key,class:C(["dot",{active:c===t(n)}]),onClick:b=>D(c),"aria-label":`Aller à l'élément ${c+1}`},null,10,se))),128))])]))]))}}),ue=V(ie,[["__scopeId","data-v-a19fbf3d"]]);export{ue as default};
