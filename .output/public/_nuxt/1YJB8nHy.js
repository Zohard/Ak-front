import{f as D,u as ie,q as de,g as v,I as B,H as c,x as ce,c as n,a as e,b as m,d as C,k as a,B as b,F as L,l as H,t as d,w as ue,r as ge,o as i,n as M,z as P,A as q,K as me,D as pe,V as be,_ as ye}from"./CCeOfYC8.js";import{u as K}from"./CC4fhe8Z.js";import{u as xe}from"./OZpmkmFW.js";import"./BJ2ClxiI.js";const ve={class:"main-content"},fe={class:"page-header"},he={class:"section-title flex items-center gap-3"},ke={class:"flex gap-6"},we={class:"w-64 bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-4"},Ce={class:"space-y-2"},_e={class:"mt-6 pt-6 border-t border-gray-200 dark:border-gray-700"},Ae={class:"flex-1"},Se={class:"mb-6"},Me={class:"border-b border-gray-200 dark:border-gray-700"},Pe={class:"-mb-px flex flex-wrap gap-2","aria-label":"Status Tabs"},Te=["onClick"],$e={class:"ml-1 text-xs opacity-70"},Ee={key:0,class:"flex items-center justify-center py-12"},Ie={key:1,class:"text-center py-12"},Ue={class:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-700 rounded-lg p-6 max-w-md mx-auto"},Ve={class:"text-red-600 dark:text-red-300 text-sm mb-4"},ze={key:2,class:"space-y-4"},Fe={class:"flex items-center gap-4"},Ne={class:"relative"},je=["src","alt"],De={class:"flex-1 min-w-0"},Be={class:"flex items-center gap-2 mb-1"},Le={class:"font-medium text-gray-900 dark:text-white truncate"},He={key:0,class:"text-sm text-gray-600 dark:text-gray-400 mt-1 line-clamp-2"},qe={class:"flex items-center gap-2 mt-2 text-xs text-gray-500 dark:text-gray-400"},Ke={key:0,class:"bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded"},Oe={key:1,class:"bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded"},Re={class:"flex items-center gap-2"},Ge=["onClick"],Qe={key:3,class:"text-center py-12"},Je={class:"text-lg font-medium text-gray-900 dark:text-white mb-2"},We={class:"text-gray-500 dark:text-gray-400 mb-4"},Xe={class:"space-y-4"},Ye={class:"flex items-center gap-2"},Ze={class:"flex justify-end gap-2 pt-2"},et=["disabled"],tt=D({__name:"my-collections",async setup(rt){let g,_;ie({title:"Mes Collections - Anime-Kun",meta:[{name:"description",content:"Gérez vos collections d'animes et mangas"}]});const f=de();f.accessToken?.value||localStorage.getItem("access_token")||window.location.replace(`/login?redirect=${encodeURIComponent("/my-collections")}`);const l=v("animes"),y=v("all"),u={all:{label:"Tous",color:"bg-gray-500",textColor:"text-gray-700",bgColor:"bg-gray-100"},"en-cours":{label:"En cours",color:"bg-blue-500",textColor:"text-blue-700",bgColor:"bg-blue-100"},termine:{label:"Terminé",color:"bg-green-500",textColor:"text-green-700",bgColor:"bg-green-100"},planifie:{label:"Planifié",color:"bg-yellow-500",textColor:"text-yellow-700",bgColor:"bg-yellow-100"},abandonne:{label:"Abandonné",color:"bg-red-500",textColor:"text-red-700",bgColor:"bg-red-100"},"en-attente":{label:"En attente",color:"bg-purple-500",textColor:"text-purple-700",bgColor:"bg-purple-100"}},{data:O,pending:R,error:G,refresh:U}=([g,_]=B(()=>K("/api/collection-animes",{headers:c(()=>f.getAuthHeaders()),params:c(()=>({id_membre:f.user?.id})),key:"anime-collections",watch:[l],server:!1,default:()=>({collections:[]})},"$sK0xabLAk1")),g=await g,_(),g),{data:Q,pending:J,error:W,refresh:V}=([g,_]=B(()=>K("/api/collection-mangas",{headers:c(()=>f.getAuthHeaders()),params:c(()=>({id_membre:f.user?.id})),key:"manga-collections",watch:[l],server:!1,default:()=>({collections:[]})},"$tyO9wUU8Tn")),g=await g,_(),g),h=c(()=>l.value==="animes"?O.value:Q.value),X=c(()=>l.value==="animes"?R.value:J.value),z=c(()=>l.value==="animes"?G.value:W.value),F=async()=>{l.value==="animes"?await U():await V()},p=D({name:"LocalIconStub",props:{name:String,size:String},setup(){return()=>be("span")}}),x=c(()=>{if(!h.value?.items&&!h.value?.collections)return[];if(h.value.items)return h.value.items;const r=[];return h.value.collections?.forEach(t=>{t.items&&r.push(...t.items)}),r}),N=c(()=>y.value==="all"?x.value:x.value.filter(r=>r.status===y.value)),Y=c(()=>{const r={all:x.value.length};return Object.keys(u).forEach(t=>{t!=="all"&&(r[t]=x.value.filter(I=>I.status===t).length)}),r}),j=async r=>{l.value=r,y.value="all"},Z=r=>{y.value=r},ee=r=>Y.value[r]||0,te=r=>u[r]?.label.toLowerCase()||r,re=r=>!r||!u[r]?u.all.color:u[r].color,T=r=>!r||!u[r]?u.all:u[r],oe=r=>{const t={all:"border-l-4 border-l-gray-400","en-cours":"border-l-4 border-l-blue-400",termine:"border-l-4 border-l-green-400",planifie:"border-l-4 border-l-yellow-400",abandonne:"border-l-4 border-l-red-400","en-attente":"border-l-4 border-l-purple-400"};return!r||!t[r]?t.all:t[r]},ae=async r=>{try{l.value==="animes"?(await A.removeAnimeFromCollection(0,r),await U()):(await A.removeMangaFromCollection(0,r),await V())}catch(t){console.error("Remove from collection error:",t)}},A=xe(),k=v(!1),S=v(!1),$=v(!1),E=v(null),s=ce({name:"",description:"",isPublic:!0,type:"animes"}),se=()=>{S.value=!1,E.value=null,s.name="",s.description="",s.isPublic=!0,s.type=l.value,k.value=!0},le=()=>{k.value=!1},ne=async()=>{if(s.name?.trim()){$.value=!0;try{if(S.value&&E.value){const r={name:s.name,description:s.description,isPublic:s.isPublic,type:s.type};await A.updateCollection(E.value,r)}else{const r={name:s.name,description:s.description,isPublic:s.isPublic,type:s.type};await A.createCollection(r)}k.value=!1,await F()}catch(r){console.error("Save collection error:",r)}finally{$.value=!1}}};return(r,t)=>{const I=ge("Modal");return i(),n("div",ve,[e("div",fe,[e("h1",he,[m(a(p),{name:"heroicons:rectangle-stack",class:"w-8 h-8 text-purple-600 dark:text-purple-400"}),t[7]||(t[7]=C(" Mes Collections ",-1))]),t[8]||(t[8]=e("p",{class:"text-lg text-gray-600 dark:text-gray-300"}," Organisez vos animes et mangas préférés ",-1))]),e("div",ke,[e("div",we,[t[12]||(t[12]=e("h3",{class:"font-semibold text-gray-900 dark:text-white mb-4"},"Type de collection",-1)),e("nav",Ce,[e("button",{class:b(["w-full text-left px-4 py-3 rounded-lg transition-colors duration-200 flex items-center gap-3",a(l)==="animes"?"bg-purple-100 dark:bg-purple-900 text-purple-700 dark:text-purple-200":"text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"]),onClick:t[0]||(t[0]=o=>j("animes"))},[m(a(p),{name:"heroicons:film",class:"w-5 h-5"}),t[9]||(t[9]=C(" Collections Animes ",-1))],2),e("button",{class:b(["w-full text-left px-4 py-3 rounded-lg transition-colors duration-200 flex items-center gap-3",a(l)==="mangas"?"bg-purple-100 dark:bg-purple-900 text-purple-700 dark:text-purple-200":"text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"]),onClick:t[1]||(t[1]=o=>j("mangas"))},[m(a(p),{name:"heroicons:book-open",class:"w-5 h-5"}),t[10]||(t[10]=C(" Collections Mangas ",-1))],2)]),e("div",_e,[e("button",{class:"btn-primary w-full justify-center",onClick:se},[m(a(p),{name:"heroicons:plus",class:"w-4 h-4 mr-2"}),t[11]||(t[11]=C(" Nouvelle collection ",-1))])])]),e("div",Ae,[e("div",Se,[e("div",Me,[e("nav",Pe,[(i(),n(L,null,H(u,(o,w)=>e("button",{key:w,class:b(["py-2 px-4 border-b-2 font-medium text-sm transition-colors duration-200 rounded-t-lg flex items-center gap-2",a(y)===w?`border-purple-500 ${o.bgColor} ${o.textColor}`:"border-transparent text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 hover:border-gray-300 dark:hover:border-gray-600"]),onClick:ot=>Z(w)},[e("div",{class:b(`w-3 h-3 rounded-full ${o.color}`)},null,2),C(" "+d(o.label)+" ",1),e("span",$e,"("+d(ee(w))+")",1)],10,Te)),64))])])]),a(X)?(i(),n("div",Ee,t[13]||(t[13]=[e("div",{class:"animate-spin rounded-full h-8 w-8 border-2 border-purple-500 border-t-transparent"},null,-1),e("span",{class:"ml-3 text-gray-600 dark:text-gray-300"},"Chargement de vos collections...",-1)]))):a(z)?(i(),n("div",Ie,[e("div",Ue,[m(a(p),{name:"heroicons:exclamation-triangle",class:"w-8 h-8 text-red-500 mx-auto mb-3"}),t[14]||(t[14]=e("h3",{class:"text-lg font-medium text-red-800 dark:text-red-200 mb-2"},"Erreur de chargement",-1)),e("p",Ve,d(a(z)),1),e("button",{class:"btn-secondary",onClick:F},"Réessayer")])])):a(N)?.length?(i(),n("div",ze,[(i(!0),n(L,null,H(a(N),o=>(i(),n("div",{key:o.id,class:b(["rounded-lg border p-4 hover:shadow-md transition-all duration-200","bg-white dark:bg-gray-800 border-gray-200 dark:border-gray-700",oe(o.status)])},[e("div",Fe,[e("div",Ne,[o.imageUrl?(i(),n("img",{key:0,src:o.imageUrl,alt:o.title||o.name,class:"w-16 h-20 object-cover rounded-md"},null,8,je)):M("",!0),e("div",{class:b(["absolute -top-2 -right-2 w-6 h-6 rounded-full border-2 border-white dark:border-gray-800",re(o.status)])},null,2)]),e("div",De,[e("div",Be,[e("h4",Le,d(o.title||o.name),1),e("span",{class:b(["px-2 py-1 text-xs font-medium rounded-full",T(o.status).bgColor,T(o.status).textColor])},d(T(o.status).label),3)]),o.description?(i(),n("p",He,d(o.description),1)):M("",!0),e("div",qe,[o.year?(i(),n("span",Ke,d(o.year),1)):M("",!0),o.progress?(i(),n("span",Oe,d(o.progress),1)):M("",!0)])]),e("div",Re,[e("button",{class:"text-red-600 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300",onClick:w=>ae(o.id)},[m(a(p),{name:"heroicons:trash",class:"w-4 h-4"})],8,Ge)])])],2))),128))])):(i(),n("div",Qe,[m(a(p),{name:"heroicons:rectangle-stack",class:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e("h3",Je,d(a(x).length===0?`Aucun ${a(l)==="animes"?"anime":"manga"} trouvé`:`Aucun ${a(l)==="animes"?"anime":"manga"} ${te(a(y))}`),1),e("p",We,d(a(x).length===0?`Commencez à ajouter des ${a(l)==="animes"?"animes":"mangas"} à votre collection`:`Changez l'état de vos ${a(l)==="animes"?"animes":"mangas"} pour les voir apparaître ici`),1)]))])]),m(I,{show:a(k),"onUpdate:show":t[6]||(t[6]=o=>k.value=o),title:a(S)?"Modifier la collection":"Nouvelle collection",size:"lg"},{default:ue(()=>[e("div",Xe,[e("div",null,[t[15]||(t[15]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Nom",-1)),P(e("input",{"onUpdate:modelValue":t[2]||(t[2]=o=>a(s).name=o),type:"text",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white",placeholder:"Ex: Favoris 2025"},null,512),[[q,a(s).name]])]),e("div",null,[t[16]||(t[16]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Description",-1)),P(e("textarea",{"onUpdate:modelValue":t[3]||(t[3]=o=>a(s).description=o),rows:"3",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white",placeholder:"Quelques mots sur cette collection"},null,512),[[q,a(s).description]])]),e("div",null,[t[18]||(t[18]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Type de collection",-1)),P(e("select",{"onUpdate:modelValue":t[4]||(t[4]=o=>a(s).type=o),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md dark:bg-gray-700 dark:text-white"},t[17]||(t[17]=[e("option",{value:"animes"},"Collection d'Animes",-1),e("option",{value:"mangas"},"Collection de Mangas",-1)]),512),[[me,a(s).type]])]),e("div",Ye,[P(e("input",{id:"isPublic",type:"checkbox","onUpdate:modelValue":t[5]||(t[5]=o=>a(s).isPublic=o),class:"h-4 w-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500"},null,512),[[pe,a(s).isPublic]]),t[19]||(t[19]=e("label",{for:"isPublic",class:"text-sm text-gray-700 dark:text-gray-300"},"Collection publique",-1))]),e("div",Ze,[e("button",{class:"btn-secondary",onClick:le},"Annuler"),e("button",{class:"btn-primary",disabled:a($),onClick:ne},d(a(S)?"Enregistrer":"Créer"),9,et)])])]),_:1},8,["show","title"])])}}}),it=ye(tt,[["__scopeId","data-v-247be414"]]);export{it as default};
