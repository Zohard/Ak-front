import{f as Y,u as ee,q as te,v as se,s as re,g as A,G as V,H as N,I as ae,c as d,a as t,n as k,b as a,d as c,B as $,k as o,z as U,A as oe,J as L,K as ne,F as _,E as le,m as M,w as y,t as u,l as z,L as ie,r as E,e as de,j as ue,o as i,_ as ce}from"./CCeOfYC8.js";import{u as me}from"./CC4fhe8Z.js";import{r as ge}from"./BYwTe9_t.js";import"./BJ2ClxiI.js";const pe={class:"main-content"},xe={class:"page-header"},ve={class:"section-title flex items-center gap-3"},ye={class:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-4 mb-6"},be={class:"flex items-center justify-center"},fe={class:"flex bg-gray-100 dark:bg-gray-700 rounded-lg p-1"},he={class:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6 mb-8"},ke={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},_e=["placeholder"],we={class:"flex items-end"},Ce={key:0,class:"flex flex-wrap items-center gap-2 mt-4 pt-4 border-t border-gray-200 dark:border-gray-700"},Ae={class:"inline-flex items-center gap-1 px-2 py-1 bg-purple-100 dark:bg-purple-900 text-purple-800 dark:text-purple-200 text-xs rounded-full"},ze={key:0,class:"flex items-center justify-center py-12"},Pe={key:1,class:"text-center py-12"},qe={class:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-700 rounded-lg p-6 max-w-md mx-auto"},Se={class:"text-red-600 dark:text-red-300 text-sm mb-4"},Ne={key:2,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},$e={class:"p-6 border-b border-gray-100 dark:border-gray-700"},Me={class:"flex items-start gap-3 mb-3"},Re={class:"w-12 h-12 rounded-full bg-gradient-to-br from-purple-500 to-blue-500 flex items-center justify-center flex-shrink-0"},Te={class:"text-white font-semibold text-lg"},je={class:"flex-1 min-w-0"},Ie={class:"font-semibold text-lg text-gray-900 dark:text-white truncate"},Be={class:"flex items-center gap-2 text-sm text-gray-500 dark:text-gray-400"},De={class:"flex items-center justify-between mb-4"},Ve={class:"flex items-center gap-4 text-sm text-gray-500 dark:text-gray-400"},Ue={class:"flex items-center gap-1"},Le={class:"flex items-center gap-1"},Ee={class:"text-sm font-medium text-purple-600 dark:text-purple-400"},Fe={class:"space-y-2"},Ze={class:"text-gray-600 dark:text-gray-400"},Je={class:"flex items-center gap-2"},He={class:"text-purple-600 dark:text-purple-400"},Ke={class:"text-blue-600 dark:text-blue-400"},Oe={class:"p-6"},Qe={key:3,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},Ge={class:"p-6 border-b border-gray-100 dark:border-gray-700"},We={class:"flex items-start gap-3 mb-3"},Xe={class:"flex-1 min-w-0"},Ye={class:"font-semibold text-lg text-gray-900 dark:text-white truncate"},et={class:"flex items-center gap-2 text-sm text-gray-500 dark:text-gray-400"},tt={class:"truncate"},st={key:0,class:"text-gray-600 dark:text-gray-400 text-sm line-clamp-2 mb-3"},rt={class:"flex items-center justify-between"},at={class:"flex items-center gap-4 text-sm text-gray-500 dark:text-gray-400"},ot={class:"flex items-center gap-1"},nt={class:"flex items-center gap-1"},lt={class:"p-6"},it={key:4,class:"text-center py-12"},dt={class:"text-lg font-medium text-gray-900 dark:text-white mb-2"},ut={class:"text-gray-500 dark:text-gray-400 mb-4"},ct={key:0,class:"space-y-2"},mt={key:5,class:"flex justify-center mt-8"},gt={class:"flex items-center space-x-1"},pt={class:"flex items-center gap-1"},xt={key:6,class:"text-center mt-4 text-sm text-gray-600 dark:text-gray-400"},vt=Y({__name:"index",async setup(yt){let C,R;ee({title:"Collections Publiques - Anime-Kun",meta:[{name:"description",content:"Découvrez les collections d'animes et mangas partagées par la communauté"}]});const F=te(),b=se(),Z=re(),p=A(1),m=A(""),g=A("createdAt"),n=A("collections");b.query.page&&(p.value=parseInt(b.query.page)||1),b.query.search&&(m.value=b.query.search),b.query.sort&&(g.value=b.query.sort),b.query.view&&(n.value=b.query.view);const P=ge(m,500);V([P,g,n],()=>{p.value=1,n.value==="users"&&!["username","-username","totalItems","-totalItems"].includes(g.value)?g.value="username":n.value==="collections"&&!["createdAt","-createdAt","name","-name","itemCount","-itemCount"].includes(g.value)&&(g.value="createdAt")});const w=()=>n.value==="users"?h.value?.meta:h.value?.pagination,J=N(()=>{const l=w();if(!l?.totalPages)return[];const e=l.totalPages,r=p.value,x=2;let v=Math.max(1,r-x),s=Math.min(e,r+x);r-x<=1&&(s=Math.min(e,5)),r+x>=e&&(v=Math.max(1,e-4));const f=[];for(let S=v;S<=s;S++)f.push(S);return f}),H=()=>n.value==="users"?m.value?"Aucun utilisateur trouvé":"Aucun utilisateur avec des collections publiques":m.value?"Aucune collection trouvée":"Aucune collection publique",K=()=>m.value?"Essayez avec d'autres mots-clés":n.value==="users"?"Aucun utilisateur n'a encore partagé de collections publiques":"Les utilisateurs n'ont pas encore partagé de collections publiques",O=()=>{const l=w();if(!l)return"";const e=n.value==="users"?"utilisateurs":"collections",r=(p.value-1)*12+1,x=Math.min(p.value*12,l.total);return`Affichage de ${r} à ${x} sur ${l.total} ${e}`},{data:h,pending:Q,error:T,refresh:G}=([C,R]=ae(()=>me(()=>n.value==="users"?"/api/collections/browse":"/api/collections",{baseURL:ue().public.apiBase,params:N(()=>{const l={page:p.value,limit:12,search:P.value||void 0};return n.value==="users"?{...l,sortBy:g.value||void 0}:{...l,isPublic:!0,sortBy:g.value||void 0}}),key:N(()=>`collections-${n.value}`),watch:[p,P,g,n]},"$R2kDcUW1QA")),C=await C,R(),C),j=l=>new Date(l).toLocaleDateString("fr-FR",{day:"numeric",month:"short",year:"numeric"}),W=l=>{const e=["bg-purple-600","bg-blue-600","bg-green-600","bg-red-600","bg-yellow-600","bg-indigo-600","bg-pink-600","bg-orange-600"];return e[l.id%e.length]},X=l=>{const e=["heroicons:star","heroicons:heart","heroicons:bookmark","heroicons:film","heroicons:book-open","heroicons:trophy","heroicons:fire","heroicons:sparkles"];return e[l.id%e.length]},q=async l=>{p.value=l,await I()},I=async()=>{await ie();const l={};p.value>1&&(l.page=p.value.toString()),m.value&&(l.search=m.value);const e=n.value==="users"?"username":"createdAt";g.value!==e&&(l.sort=g.value),n.value!=="collections"&&(l.view=n.value);const r=b.query;if(JSON.stringify(l)!==JSON.stringify(r))try{await Z.push({query:l})}catch(v){console.debug("Navigation ignored:",v)}},B=()=>{m.value="",g.value=n.value==="users"?"username":"createdAt"};V([m,g,n],()=>{clearTimeout(D),D=setTimeout(I,300)});let D;return(l,e)=>{const r=E("Icon"),x=de,v=E("Button");return i(),d("div",pe,[t("div",xe,[t("h1",ve,[a(r,{name:"heroicons:globe-alt",class:"w-8 h-8 text-purple-600 dark:text-purple-400"}),e[7]||(e[7]=c(" Collections Publiques ",-1))]),e[8]||(e[8]=t("p",{class:"text-lg text-gray-600 dark:text-gray-300"}," Découvrez les collections d'animes et mangas partagées par la communauté ",-1))]),t("div",ye,[t("div",be,[t("div",fe,[t("button",{class:$(["px-4 py-2 rounded-md text-sm font-medium transition-colors",o(n)==="collections"?"bg-white dark:bg-gray-600 text-gray-900 dark:text-white shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"]),onClick:e[0]||(e[0]=s=>n.value="collections")},[a(r,{name:"heroicons:rectangle-stack",size:"xs",class:"mr-2"}),e[9]||(e[9]=c(" Collections Publiques ",-1))],2),t("button",{class:$(["px-4 py-2 rounded-md text-sm font-medium transition-colors",o(n)==="users"?"bg-white dark:bg-gray-600 text-gray-900 dark:text-white shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"]),onClick:e[1]||(e[1]=s=>n.value="users")},[a(r,{name:"heroicons:users",size:"xs",class:"mr-2"}),e[10]||(e[10]=c(" Parcourir les Utilisateurs ",-1))],2)])])]),t("div",he,[t("div",ke,[t("div",null,[e[11]||(e[11]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Recherche ",-1)),U(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>L(m)?m.value=s:null),type:"text",placeholder:o(n)==="users"?"Nom d'utilisateur...":"Nom de la collection...",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-purple-500 focus:border-purple-500 dark:bg-gray-700 dark:text-white"},null,8,_e),[[oe,o(m)]])]),t("div",null,[e[17]||(e[17]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Trier par ",-1)),U(t("select",{"onUpdate:modelValue":e[3]||(e[3]=s=>L(g)?g.value=s:null),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-purple-500 focus:border-purple-500 dark:bg-gray-700 dark:text-white"},[o(n)==="users"?(i(),d(_,{key:0},[e[12]||(e[12]=t("option",{value:"username"},"Nom A-Z",-1)),e[13]||(e[13]=t("option",{value:"-username"},"Nom Z-A",-1)),e[14]||(e[14]=t("option",{value:"totalItems"},"Plus d'éléments",-1)),e[15]||(e[15]=t("option",{value:"-totalItems"},"Moins d'éléments",-1))],64)):(i(),d(_,{key:1},[e[16]||(e[16]=le('<option value="createdAt" data-v-b71af932>Plus récentes</option><option value="-createdAt" data-v-b71af932>Plus anciennes</option><option value="name" data-v-b71af932>Nom A-Z</option><option value="-name" data-v-b71af932>Nom Z-A</option><option value="itemCount" data-v-b71af932>Plus d&#39;éléments</option><option value="-itemCount" data-v-b71af932>Moins d&#39;éléments</option>',6))],64))],512),[[ne,o(g)]])]),t("div",we,[o(F).isAuthenticated?(i(),M(x,{key:0,to:"/my-collections",class:"btn-primary flex items-center gap-2 w-full justify-center"},{default:y(()=>[a(r,{name:"heroicons:plus",size:"sm"}),e[18]||(e[18]=c(" Mes Collections ",-1))]),_:1,__:[18]})):(i(),M(x,{key:1,to:"/login",class:"btn-secondary flex items-center gap-2 w-full justify-center"},{default:y(()=>[a(r,{name:"heroicons:user",size:"sm"}),e[19]||(e[19]=c(" Se connecter ",-1))]),_:1,__:[19]}))])]),o(m)?(i(),d("div",Ce,[e[20]||(e[20]=t("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"Filtres actifs:",-1)),t("span",Ae,[c(' Recherche: "'+u(o(m))+'" ',1),t("button",{onClick:e[4]||(e[4]=s=>m.value=""),class:"hover:bg-purple-200 dark:hover:bg-purple-800 rounded-full p-0.5"},[a(r,{name:"heroicons:x-mark",class:"w-3 h-3"})])]),t("button",{onClick:B,class:"text-xs text-red-600 dark:text-red-400 hover:text-red-700 dark:hover:text-red-300 font-medium"}," Tout effacer ")])):k("",!0)]),o(Q)?(i(),d("div",ze,e[21]||(e[21]=[t("div",{class:"animate-spin rounded-full h-8 w-8 border-2 border-purple-500 border-t-transparent"},null,-1),t("span",{class:"ml-3 text-gray-600 dark:text-gray-300"},"Chargement des collections...",-1)]))):o(T)?(i(),d("div",Pe,[t("div",qe,[a(r,{name:"heroicons:exclamation-triangle",class:"w-8 h-8 text-red-500 mx-auto mb-3"}),e[23]||(e[23]=t("h3",{class:"text-lg font-medium text-red-800 dark:text-red-200 mb-2"},"Erreur de chargement",-1)),t("p",Se,u(o(T)),1),a(v,{onClick:o(G),variant:"secondary"},{default:y(()=>e[22]||(e[22]=[c("Réessayer",-1)])),_:1,__:[22]},8,["onClick"])])])):k("",!0),o(n)==="users"&&o(h)?.data?.length?(i(),d("div",Ne,[(i(!0),d(_,null,z(o(h).data,s=>(i(),d("div",{key:s.id,class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden hover:shadow-lg transition-all duration-300 group"},[t("div",$e,[t("div",Me,[t("div",Re,[t("span",Te,u(s.username.charAt(0).toUpperCase()),1)]),t("div",je,[t("h3",Ie,u(s.username),1),t("div",Be,[a(r,{name:"heroicons:calendar",size:"xs"}),t("span",null,"Membre depuis "+u(j(s.joinedAt)),1)])])]),t("div",De,[t("div",Ve,[t("span",Ue,[a(r,{name:"heroicons:film",size:"xs"}),c(" "+u(s.totalPublicAnimes)+" animes ",1)]),t("span",Le,[a(r,{name:"heroicons:book-open",size:"xs"}),c(" "+u(s.totalPublicMangas)+" mangas ",1)])]),t("span",Ee,u(s.totalPublicItems)+" total ",1)]),t("div",Fe,[(i(!0),d(_,null,z(s.collections,f=>(i(),d("div",{key:f.type,class:"flex items-center justify-between text-xs"},[t("span",Ze,u(f.name),1),t("div",Je,[t("span",He,u(f.animeCount)+"A",1),t("span",Ke,u(f.mangaCount)+"M",1)])]))),128))])]),t("div",Oe,[a(x,{to:`/user/${s.username}`,class:"block w-full text-center py-2 px-4 bg-purple-600 hover:bg-purple-700 text-white font-medium rounded-lg transition-colors duration-200 mb-2"},{default:y(()=>[e[24]||(e[24]=c(" Voir le profil ",-1)),a(r,{name:"heroicons:user",size:"xs",class:"ml-2"})]),_:2,__:[24]},1032,["to"]),a(x,{to:`/collections/user/${s.id}`,class:"block w-full text-center py-2 px-4 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 font-medium rounded-lg transition-colors duration-200"},{default:y(()=>[e[25]||(e[25]=c(" Voir les collections ",-1)),a(r,{name:"heroicons:rectangle-stack",size:"xs",class:"ml-2"})]),_:2,__:[25]},1032,["to"])])]))),128))])):o(n)==="collections"&&o(h)?.collections?.length?(i(),d("div",Qe,[(i(!0),d(_,null,z(o(h).collections,s=>(i(),d("div",{key:s.id,class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden hover:shadow-lg transition-all duration-300 group"},[t("div",Ge,[t("div",We,[t("div",{class:$(["w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0",W(s)])},[a(r,{name:X(s),size:"sm",class:"text-white"},null,8,["name"])],2),t("div",Xe,[t("h3",Ye,u(s.name),1),t("div",et,[a(r,{name:"heroicons:user",size:"xs"}),t("span",tt,u(s.user?.pseudo||"Utilisateur"),1),e[26]||(e[26]=t("span",null,"•",-1)),a(r,{name:"heroicons:calendar",size:"xs"}),t("span",null,u(j(s.createdAt)),1)])])]),s.description?(i(),d("p",st,u(s.description),1)):k("",!0),t("div",rt,[t("div",at,[t("span",ot,[a(r,{name:"heroicons:rectangle-stack",size:"xs"}),c(" "+u(s.itemCount||0)+" éléments ",1)]),t("span",nt,[a(r,{name:"heroicons:globe-alt",size:"xs"}),e[27]||(e[27]=c(" Public ",-1))])])])]),t("div",lt,[a(x,{to:`/collections/${s.id}`,class:"block w-full text-center py-2 px-4 bg-purple-600 hover:bg-purple-700 text-white font-medium rounded-lg transition-colors duration-200"},{default:y(()=>[e[28]||(e[28]=c(" Voir la collection ",-1)),a(r,{name:"heroicons:arrow-right",size:"xs",class:"ml-2"})]),_:2,__:[28]},1032,["to"])])]))),128))])):(i(),d("div",it,[a(r,{name:o(n)==="users"?"heroicons:users":"heroicons:rectangle-stack",class:"w-16 h-16 text-gray-400 mx-auto mb-4"},null,8,["name"]),t("h3",dt,u(H()),1),t("p",ut,u(K()),1),o(m)?(i(),d("div",ct,[a(v,{onClick:B,variant:"secondary"},{default:y(()=>e[29]||(e[29]=[c(" Effacer les filtres ",-1)])),_:1,__:[29]})])):k("",!0)])),w()?.totalPages>1?(i(),d("div",mt,[t("div",gt,[a(v,{disabled:o(p)===1,onClick:e[5]||(e[5]=s=>q(o(p)-1)),variant:"secondary",size:"sm"},{default:y(()=>[a(r,{name:"heroicons:chevron-left",size:"xs",class:"mr-1"}),e[30]||(e[30]=c(" Précédent ",-1))]),_:1,__:[30]},8,["disabled"]),t("div",pt,[(i(!0),d(_,null,z(o(J),s=>(i(),M(v,{key:s,variant:s===o(p)?"primary":"ghost",size:"sm",onClick:f=>q(s)},{default:y(()=>[c(u(s),1)]),_:2},1032,["variant","onClick"]))),128))]),a(v,{disabled:o(p)===w()?.totalPages,onClick:e[6]||(e[6]=s=>q(o(p)+1)),variant:"secondary",size:"sm"},{default:y(()=>[e[31]||(e[31]=c(" Suivant ",-1)),a(r,{name:"heroicons:chevron-right",size:"xs",class:"ml-1"})]),_:1,__:[31]},8,["disabled"])])])):k("",!0),w()?(i(),d("div",xt,u(O()),1)):k("",!0)])}}}),_t=ce(vt,[["__scopeId","data-v-b71af932"]]);export{_t as default};
