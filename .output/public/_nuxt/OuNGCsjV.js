import{f as K,u as O,q as Q,v as Z,s as G,g as C,G as S,H as T,I as W,c,a as t,n as v,b as n,d as m,z as B,A as X,k as s,J as D,K as Y,E as ee,m as z,w as y,t as u,F as M,l as L,L as te,e as se,r as V,j as re,o as i,B as ae,_ as oe}from"./Bes98wj2.js";import{u as ne}from"./DuWR0lLf.js";import{r as ie}from"./DKV7c2p8.js";import"./BJ2ClxiI.js";const le={class:"main-content"},de={class:"page-header"},ce={class:"section-title flex items-center gap-3"},ue={class:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6 mb-8"},me={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},pe={class:"flex items-end"},ge={key:0,class:"flex flex-wrap items-center gap-2 mt-4 pt-4 border-t border-gray-200 dark:border-gray-700"},xe={class:"inline-flex items-center gap-1 px-2 py-1 bg-purple-100 dark:bg-purple-900 text-purple-800 dark:text-purple-200 text-xs rounded-full"},be={key:0,class:"flex items-center justify-center py-12"},ye={key:1,class:"text-center py-12"},fe={class:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-700 rounded-lg p-6 max-w-md mx-auto"},ve={class:"text-red-600 dark:text-red-300 text-sm mb-4"},he={key:2,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},ke={class:"p-6 border-b border-gray-100 dark:border-gray-700"},_e={class:"flex items-start gap-3 mb-3"},we={class:"flex-1 min-w-0"},Ce={class:"font-semibold text-lg text-gray-900 dark:text-white truncate"},ze={class:"flex items-center gap-2 text-sm text-gray-500 dark:text-gray-400"},Ae={class:"truncate"},Pe={key:0,class:"text-gray-600 dark:text-gray-400 text-sm line-clamp-2 mb-3"},qe={class:"flex items-center justify-between"},Ne={class:"flex items-center gap-4 text-sm text-gray-500 dark:text-gray-400"},Re={class:"flex items-center gap-1"},Se={class:"flex items-center gap-1"},Te={class:"p-6"},Be={key:3,class:"text-center py-12"},De={class:"text-lg font-medium text-gray-900 dark:text-white mb-2"},Me={class:"text-gray-500 dark:text-gray-400 mb-4"},Le={key:0,class:"space-y-2"},Ve={key:4,class:"flex justify-center mt-8"},je={class:"flex items-center space-x-1"},Ue={class:"flex items-center gap-1"},Fe={key:5,class:"text-center mt-4 text-sm text-gray-600 dark:text-gray-400"},Ie=K({__name:"index",async setup($e){let h,A;O({title:"Collections Publiques - Anime-Kun",meta:[{name:"description",content:"Découvrez les collections d'animes et mangas partagées par la communauté"}]});const j=Q(),f=Z(),U=G(),l=C(1),d=C(""),p=C("createdAt");f.query.page&&(l.value=parseInt(f.query.page)||1),f.query.search&&(d.value=f.query.search),f.query.sort&&(p.value=f.query.sort);const _=ie(d,500);S([_,p],()=>{l.value=1});const F=T(()=>{if(!g.value?.pagination?.totalPages)return[];const o=g.value.pagination.totalPages,e=l.value,a=2;let x=Math.max(1,e-a),b=Math.min(o,e+a);e-a<=1&&(b=Math.min(o,5)),e+a>=o&&(x=Math.max(1,o-4));const r=[];for(let k=x;k<=b;k++)r.push(k);return r}),{data:g,pending:I,error:P,refresh:$}=([h,A]=W(()=>ne("/api/collections",{baseURL:re().public.apiBase,params:T(()=>({page:l.value,limit:12,search:_.value||void 0,isPublic:!0,sortBy:p.value||void 0})),key:"public-collections",watch:[l,_,p]},"$R2kDcUW1QA")),h=await h,A(),h),E=o=>new Date(o).toLocaleDateString("fr-FR",{day:"numeric",month:"short",year:"numeric"}),J=o=>{const e=["bg-purple-600","bg-blue-600","bg-green-600","bg-red-600","bg-yellow-600","bg-indigo-600","bg-pink-600","bg-orange-600"];return e[o.id%e.length]},H=o=>{const e=["heroicons:star","heroicons:heart","heroicons:bookmark","heroicons:film","heroicons:book-open","heroicons:trophy","heroicons:fire","heroicons:sparkles"];return e[o.id%e.length]},w=async o=>{l.value=o,await q()},q=async()=>{await te();const o={};l.value>1&&(o.page=l.value.toString()),d.value&&(o.search=d.value),p.value!=="createdAt"&&(o.sort=p.value);const e=f.query;if(JSON.stringify(o)!==JSON.stringify(e))try{await U.push({query:o})}catch(x){console.debug("Navigation ignored:",x)}},N=()=>{d.value="",p.value="createdAt"};S([d,p],()=>{clearTimeout(R),R=setTimeout(q,300)});let R;return(o,e)=>{const a=V("Icon"),x=se,b=V("Button");return i(),c("div",le,[t("div",de,[t("h1",ce,[n(a,{name:"heroicons:globe-alt",class:"w-8 h-8 text-purple-600 dark:text-purple-400"}),e[5]||(e[5]=m(" Collections Publiques ",-1))]),e[6]||(e[6]=t("p",{class:"text-lg text-gray-600 dark:text-gray-300"}," Découvrez les collections d'animes et mangas partagées par la communauté ",-1))]),t("div",ue,[t("div",me,[t("div",null,[e[7]||(e[7]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Recherche ",-1)),B(t("input",{"onUpdate:modelValue":e[0]||(e[0]=r=>D(d)?d.value=r:null),type:"text",placeholder:"Nom de la collection...",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-purple-500 focus:border-purple-500 dark:bg-gray-700 dark:text-white"},null,512),[[X,s(d)]])]),t("div",null,[e[9]||(e[9]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Trier par ",-1)),B(t("select",{"onUpdate:modelValue":e[1]||(e[1]=r=>D(p)?p.value=r:null),class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-purple-500 focus:border-purple-500 dark:bg-gray-700 dark:text-white"},e[8]||(e[8]=[ee('<option value="createdAt" data-v-b9ec8420>Plus récentes</option><option value="-createdAt" data-v-b9ec8420>Plus anciennes</option><option value="name" data-v-b9ec8420>Nom A-Z</option><option value="-name" data-v-b9ec8420>Nom Z-A</option><option value="itemCount" data-v-b9ec8420>Plus d&#39;éléments</option><option value="-itemCount" data-v-b9ec8420>Moins d&#39;éléments</option>',6)]),512),[[Y,s(p)]])]),t("div",pe,[s(j).isAuthenticated?(i(),z(x,{key:0,to:"/my-collections",class:"btn-primary flex items-center gap-2 w-full justify-center"},{default:y(()=>[n(a,{name:"heroicons:plus",size:"sm"}),e[10]||(e[10]=m(" Mes Collections ",-1))]),_:1,__:[10]})):(i(),z(x,{key:1,to:"/login",class:"btn-secondary flex items-center gap-2 w-full justify-center"},{default:y(()=>[n(a,{name:"heroicons:user",size:"sm"}),e[11]||(e[11]=m(" Se connecter ",-1))]),_:1,__:[11]}))])]),s(d)?(i(),c("div",ge,[e[12]||(e[12]=t("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"Filtres actifs:",-1)),t("span",xe,[m(' Recherche: "'+u(s(d))+'" ',1),t("button",{onClick:e[2]||(e[2]=r=>d.value=""),class:"hover:bg-purple-200 dark:hover:bg-purple-800 rounded-full p-0.5"},[n(a,{name:"heroicons:x-mark",class:"w-3 h-3"})])]),t("button",{onClick:N,class:"text-xs text-red-600 dark:text-red-400 hover:text-red-700 dark:hover:text-red-300 font-medium"}," Tout effacer ")])):v("",!0)]),s(I)?(i(),c("div",be,e[13]||(e[13]=[t("div",{class:"animate-spin rounded-full h-8 w-8 border-2 border-purple-500 border-t-transparent"},null,-1),t("span",{class:"ml-3 text-gray-600 dark:text-gray-300"},"Chargement des collections...",-1)]))):s(P)?(i(),c("div",ye,[t("div",fe,[n(a,{name:"heroicons:exclamation-triangle",class:"w-8 h-8 text-red-500 mx-auto mb-3"}),e[15]||(e[15]=t("h3",{class:"text-lg font-medium text-red-800 dark:text-red-200 mb-2"},"Erreur de chargement",-1)),t("p",ve,u(s(P)),1),n(b,{onClick:s($),variant:"secondary"},{default:y(()=>e[14]||(e[14]=[m("Réessayer",-1)])),_:1,__:[14]},8,["onClick"])])])):s(g)?.collections?.length?(i(),c("div",he,[(i(!0),c(M,null,L(s(g).collections,r=>(i(),c("div",{key:r.id,class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 overflow-hidden hover:shadow-lg transition-all duration-300 group"},[t("div",ke,[t("div",_e,[t("div",{class:ae(["w-10 h-10 rounded-lg flex items-center justify-center flex-shrink-0",J(r)])},[n(a,{name:H(r),size:"sm",class:"text-white"},null,8,["name"])],2),t("div",we,[t("h3",Ce,u(r.name),1),t("div",ze,[n(a,{name:"heroicons:user",size:"xs"}),t("span",Ae,u(r.user?.pseudo||"Utilisateur"),1),e[16]||(e[16]=t("span",null,"•",-1)),n(a,{name:"heroicons:calendar",size:"xs"}),t("span",null,u(E(r.createdAt)),1)])])]),r.description?(i(),c("p",Pe,u(r.description),1)):v("",!0),t("div",qe,[t("div",Ne,[t("span",Re,[n(a,{name:"heroicons:rectangle-stack",size:"xs"}),m(" "+u(r.itemCount||0)+" éléments ",1)]),t("span",Se,[n(a,{name:"heroicons:globe-alt",size:"xs"}),e[17]||(e[17]=m(" Public ",-1))])])])]),t("div",Te,[n(x,{to:`/collections/${r.id}`,class:"block w-full text-center py-2 px-4 bg-purple-600 hover:bg-purple-700 text-white font-medium rounded-lg transition-colors duration-200"},{default:y(()=>[e[18]||(e[18]=m(" Voir la collection ",-1)),n(a,{name:"heroicons:arrow-right",size:"xs",class:"ml-2"})]),_:2,__:[18]},1032,["to"])])]))),128))])):(i(),c("div",Be,[n(a,{name:"heroicons:rectangle-stack",class:"w-16 h-16 text-gray-400 mx-auto mb-4"}),t("h3",De,u(s(d)?"Aucune collection trouvée":"Aucune collection publique"),1),t("p",Me,u(s(d)?"Essayez avec d'autres mots-clés":"Les utilisateurs n'ont pas encore partagé de collections publiques"),1),s(d)?(i(),c("div",Le,[n(b,{onClick:N,variant:"secondary"},{default:y(()=>e[19]||(e[19]=[m(" Effacer les filtres ",-1)])),_:1,__:[19]})])):v("",!0)])),s(g)?.pagination?.totalPages>1?(i(),c("div",Ve,[t("div",je,[n(b,{disabled:s(l)===1,onClick:e[3]||(e[3]=r=>w(s(l)-1)),variant:"secondary",size:"sm"},{default:y(()=>[n(a,{name:"heroicons:chevron-left",size:"xs",class:"mr-1"}),e[20]||(e[20]=m(" Précédent ",-1))]),_:1,__:[20]},8,["disabled"]),t("div",Ue,[(i(!0),c(M,null,L(s(F),r=>(i(),z(b,{key:r,variant:r===s(l)?"primary":"ghost",size:"sm",onClick:k=>w(r)},{default:y(()=>[m(u(r),1)]),_:2},1032,["variant","onClick"]))),128))]),n(b,{disabled:s(l)===s(g).pagination.totalPages,onClick:e[4]||(e[4]=r=>w(s(l)+1)),variant:"secondary",size:"sm"},{default:y(()=>[e[21]||(e[21]=m(" Suivant ",-1)),n(a,{name:"heroicons:chevron-right",size:"xs",class:"ml-1"})]),_:1,__:[21]},8,["disabled"])])])):v("",!0),s(g)?.pagination?(i(),c("div",Fe," Affichage de "+u((s(l)-1)*12+1)+" à "+u(Math.min(s(l)*12,s(g).pagination.total))+" sur "+u(s(g).pagination.total)+" collections ",1)):v("",!0)])}}}),Oe=oe(Ie,[["__scopeId","data-v-b9ec8420"]]);export{Oe as default};
